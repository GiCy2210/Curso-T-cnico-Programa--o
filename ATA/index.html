<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Igreja Adventista - ATA Digital</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #3a6447;
            --primary-dark: #3e6c3c;
            --primary-light: #54bc75;
            --secondary: #ac3838;
            --secondary-light: #b30000;
            --light: #f8faf9;
            --dark: #343a40;
            --gray: #728476;
            --gray-light: #e9efeb;
            --success: #28a745;
            --border: #dee6de;
            --gold: #d4af37;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.18);
            --gradient-primary: linear-gradient(135deg, var(--primary), var(--primary-dark));
            --gradient-secondary: linear-gradient(135deg, var(--secondary), var(--secondary-light));
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
            background-color: rgba(208, 255, 200, 0.498)
        }
        
        /* Barra de navegação superior */
        .top-nav {
            background: var(--gradient-primary);
            padding: 0.8rem 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .nav-logo i {
            font-size: 1.5rem;
        }
        
        .nav-buttons {
            display: flex;
            gap: 1rem;
        }
        
        .nav-btn {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: none;
            padding: 0.7rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }
        
        .nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        header {
            background: url('https://img.freepik.com/fotos-gratis/jovens-a-relaxar-juntos_23-2151561975.jpg?semt=ais_hybrid&w=740&q=80');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: rgb(255, 255, 255);
            padding: 2.5rem 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
            position: relative;
            min-height: 380px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.3) 100%);
            z-index: 1;
        }
        
        .header-content {
            max-width: 800px;
            z-index: 2;
            position: relative;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .logo {
            font-size: 3.5rem;
            color: white;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            background: rgba(255, 255, 255, 0.15);
            width: 90px;
            height: 90px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.4rem;
            opacity: 0.95;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.4);
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .header-text {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.95;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 2.5rem auto;
            padding: 0 1.5rem;
        }
        
        .card {
            background: rgb(255, 255, 255);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2.5rem;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        /* Estilos da tela inicial */
        .intro-section {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }
        
        .intro-section::after {
            content: '';
            display: block;
            width: 100px;
            height: 4px;
            background: var(--gradient-primary);
            margin: 1.5rem auto;
            border-radius: 2px;
        }
        
        .intro-section h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .intro-section p {
            max-width: 800px;
            margin: 0 auto 1.5rem;
            font-size: 1.15rem;
            line-height: 1.7;
        }
        
        .doctrines-section {
            margin-bottom: 2.5rem;
        }
        
        .doctrines-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .doctrines-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.8rem;
        }
        
        .doctrine-card {
            background: linear-gradient(145deg, #d0ffc8, #86c787bd);
            border-radius: 12px;
            padding: 1.8rem;
            border-left: 5px solid var(--primary);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }
        
        .doctrine-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }
        
        .doctrine-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
            color: white;
        }
        
        .doctrine-card:hover::before {
            opacity: 1;
        }
        
        .doctrine-card:hover h3,
        .doctrine-card:hover p,
        .doctrine-card:hover i {
            color: white;
            position: relative;
            z-index: 1;
        }
        
        .doctrine-card h3 {
            color: var(--primary-dark);
            margin-bottom: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            font-size: 1.3rem;
            transition: color 0.3s ease;
        }
        
        .doctrine-card h3 i {
            color: var(--secondary);
            transition: color 0.3s ease;
        }
        
        .doctrine-card p {
            transition: color 0.3s ease;
        }
        
        .commissions-section {
            margin-bottom: 2.5rem;
        }
        
        .commissions-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .commissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.8rem;
        }
        
        .commission-card {
            background: rgb(207, 245, 224);
            border-radius: 12px;
            padding: 2rem 1.5rem;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.4s ease;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }
        
        .commission-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 0;
        }
        
        .commission-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            color: white;
        }
        
        .commission-card:hover::before {
            opacity: 1;
        }
        
        .commission-card:hover h3,
        .commission-card:hover p,
        .commission-card:hover .commission-icon {
            color: white;
            position: relative;
            z-index: 1;
        }
        
        .commission-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1.2rem;
            transition: color 0.4s ease;
        }
        
        .commission-card h3 {
            color: var(--primary-dark);
            margin-bottom: 0.8rem;
            font-size: 1.3rem;
            transition: color 0.4s ease;
        }
        
        .commission-card p {
            transition: color 0.4s ease;
        }
        
        /* Estilos do sistema de ATAs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 2rem;
            background: var(--gray-light);
            border-radius: 8px 8px 0 0;
            padding: 0.5rem;
        }
        
        .tab {
            padding: 0.9rem 1.8rem;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            border-radius: 6px;
            transition: all 0.3s ease;
            margin-right: 0.5rem;
        }
        
        .tab.active {
            color: white;
            background: var(--gradient-primary);
            box-shadow: 0 4px 10px rgba(44, 90, 160, 0.3);
        }
        
        .tab:hover:not(.active) {
            background: rgba(44, 90, 160, 0.1);
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        h2 {
            font-size: 1.8rem;
            margin-bottom: 1.2rem;
            color: var(--primary);
            font-weight: 700;
        }
        
        h3 {
            font-size: 1.4rem;
            margin: 1.8rem 0 1.2rem;
            color: var(--primary-dark);
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 0.6rem;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 1.8rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.6rem;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.2);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 1.2rem;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            padding: 0.9rem 1.8rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.7rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(44, 90, 160, 0.4);
        }
        
        .btn-secondary {
            background: #e9ecef;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #dee2e6;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4);
        }
        
        .btn-sm {
            padding: 0.6rem 1.2rem;
            font-size: 0.875rem;
        }
        
        .actions {
            display: flex;
            gap: 1.2rem;
            justify-content: center;
            margin-top: 2.5rem;
        }
        
        .system-actions {
            justify-content: flex-end;
        }
        
        .members-list {
            margin-top: 1.2rem;
        }
        
        .member-item {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.9rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .member-item:hover {
            background: var(--gray-light);
            transform: translateX(5px);
        }
        
        .member-actions {
            margin-left: auto;
            display: flex;
            gap: 0.6rem;
        }
        
        .history-list {
            list-style: none;
        }
        
        .history-item {
            padding: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .history-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .history-info {
            flex: 1;
        }
        
        .history-title {
            font-weight: 700;
            margin-bottom: 0.4rem;
            color: var(--primary-dark);
            font-size: 1.1rem;
        }
        
        .history-details {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .history-actions {
            display: flex;
            gap: 0.6rem;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }
        
        footer {
            text-align: center;
            padding: 2.5rem;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid var(--border);
            margin-top: 3rem;
            background: white;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .system-actions {
                flex-direction: column;
            }
            
            .history-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1.2rem;
            }
            
            .history-actions {
                align-self: flex-end;
            }
            
            .doctrines-grid,
            .commissions-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                min-height: 320px;
                padding: 2rem 1rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }
            
            .logo {
                font-size: 2.8rem;
                width: 70px;
                height: 70px;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1;
                min-width: 120px;
                margin-bottom: 0.5rem;
            }
            
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-buttons {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
        }
        
        .preview-container {
            background: #f8f9fa;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin-top: 1.8rem;
            max-height: 500px;
            overflow-y: auto;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .ata-preview {
            background: white;
            padding: 2.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            font-family: 'Times New Roman', serif;
            line-height: 1.8;
            border: 1px solid #e0e0e0;
        }
        
        .ata-header {
            text-align: center;
            margin-bottom: 2.5rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 1.5rem;
        }
        
        .ata-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 1.2rem;
            color: var(--primary-dark);
        }
        
        .ata-subtitle {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: var(--primary);
        }
        
        .ata-body {
            margin-bottom: 2.5rem;
        }
        
        .ata-signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 3.5rem;
        }
        
        .signature-line {
            border-top: 1px solid #000;
            width: 220px;
            text-align: center;
            padding-top: 0.8rem;
        }
        
        /* Navegação entre telas */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        .back-button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            margin-bottom: 1.5rem;
            padding: 0.7rem 0;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            color: var(--primary-dark);
            transform: translateX(-5px);
        }
        
        /* Novos estilos para os campos de hinos, oração e versículo */
        .hymn-item {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.9rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .hymn-item:hover {
            background: var(--gray-light);
            transform: translateX(5px);
        }
        
        .hymn-number {
            font-weight: bold;
            color: var(--primary);
            min-width: 70px;
            background: var(--gray-light);
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            text-align: center;
        }
        
        .hymn-title {
            flex: 1;
        }
        
        .worship-section {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 1.8rem;
            border-left: 5px solid var(--primary-dark);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        
        .worship-section h3 {
            color: var(--secondary);
            border-bottom: none;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        
        .worship-section h3 i {
            color: var(--secondary);
        }
        
        /* Decorative elements */
        .section-divider {
            height: 4px;
            width: 100px;
            background: var(--gradient-primary);
            margin: 2rem auto;
            border-radius: 2px;
        }
        
        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            z-index: 0;
        }
        
        .floating-element {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
            }
            100% {
                transform: translateY(0) rotate(360deg);
            }
        }
        
        /* Selection state for commission cards */
        .commission-card.selected {
            border: 2px solid var(--primary);
            background: var(--primary);
            color: white;
        }
        
        .commission-card.selected h3,
        .commission-card.selected p,
        .commission-card.selected .commission-icon {
            color: white;
        }
        
        /* Estilos para a tela de dúvidas */
        .faq-section {
            margin-bottom: 2.5rem;
        }
        
        .faq-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .faq-item {
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .faq-question {
            background: var(--gray-light);
            padding: 1.2rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .faq-question:hover {
            background: #dee2e6;
        }
        
        .faq-answer {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid var(--border);
            display: none;
        }
        
        .faq-item.active .faq-answer {
            display: block;
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .contact-form {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 2rem;
            border-radius: 12px;
            margin-top: 2rem;
            border-left: 5px solid var(--primary-dark);
        }
        
        .contact-form h3 {
            color: var(--primary);
            border-bottom: none;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <!-- Barra de navegação superior -->
    <div class="top-nav">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-church"></i>
                <span>Igreja Adventista</span>
            </div>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showHomeScreen()">
                    <i class="fas fa-home"></i> Início
                </button>
                <button class="nav-btn" onclick="showATASystem()">
                    <i class="fas fa-file-alt"></i> Criar ATA
                </button>
                <button class="nav-btn" onclick="showFAQScreen()">
                    <i class="fas fa-question-circle"></i> Dúvidas
                </button>
            </div>
        </div>
    </div>
    
    <header>
        <div class="floating-elements">
            <div class="floating-element" style="width: 80px; height: 80px; top: 10%; left: 5%;"></div>
            <div class="floating-element" style="width: 60px; height: 60px; top: 70%; left: 80%;"></div>
            <div class="floating-element" style="width: 100px; height: 100px; top: 40%; left: 90%;"></div>
            <div class="floating-element" style="width: 50px; height: 50px; top: 20%; left: 70%;"></div>
        </div>
        
        <div class="header-content">
            <div class="logo-container">
                <i class="fas fa-church logo"></i>
                <div>
                    <h1>Igreja Adventista do Sétimo Dia</h1>
                    <p class="subtitle" id="subtitle">ATA Digital - Sistema de Registro de Atas</p>
                </div>
            </div>
            <p class="header-text">Sistema digital para criação e gerenciamento de atas de reuniões e assembleias da igreja</p>
        </div>
    </header>
    
    <!-- TELA INICIAL -->
    <div class="container screen active" id="home-screen">
        <div class="card">
            <div class="intro-section">
                <h2>Bem-vindo ao Sistema ATA Digital</h2>
                <p>A Igreja Adventista do Sétimo Dia é uma comunidade cristã protestante que se destaca por sua ênfase na observância do sábado como dia de descanso e adoração, na iminente segunda vinda de Jesus Cristo e na adoção de um estilo de vida saudável.</p>
                <p>Fundada em 1863, a denominação cresceu para se tornar uma organização religiosa global com milhões de membros em todo o mundo, mantendo uma forte ênfase missionária e educacional.</p>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="doctrines-section">
                <h2>Doutrinas Principais</h2>
                <div class="doctrines-grid">
                    <!-- Cards de doutrinas (mantidos do código anterior) -->
                    <div class="doctrine-card">
                        <h3><i class="fas fa-bible"></i> A Bíblia como Regra de Fé</h3>
                        <p>Cremos que a Bíblia é a Palavra de Deus, a revelação de Sua vontade para a humanidade e o padrão suprema de toda doutrina e experiência.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-cross"></i> Salvação por meio de Cristo</h3>
                        <p>Cremos que a salvação é um dom gratuito de Deus recebido pela fé em Jesus Cristo, que morreu pelos nossos pecados e ressuscitou para nossa justificação.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-calendar-day"></i> O Sábado Sagrado</h3>
                        <p>Cremos que o sétimo dia da semana, o sábado, é o dia de descanso e adoração estabelecido por Deus na criação e confirmado nos Dez Mandamentos.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-undo-alt"></i> A Segunda Vinda de Cristo</h3>
                        <p>Cremos na breve e visível volta de Jesus Cristo em glória e poder, que marcará o fim do pecado e o estabelecimento do Seu reino eterno.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-tint"></i> O Batismo por Imersão</h3>
                        <p>Cremos no batismo por imersão como símbolo público de nossa fé em Cristo, morte para o pecado e ressurreição para uma nova vida.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-heartbeat"></i> O Ministério de Cristo no Santuário Celestial</h3>
                        <p>Cremos que Cristo iniciou em 1844 um ministério especial de juízo investigativo no santuário celestial, preparando o caminho para Sua segunda vinda.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-apple-alt"></i> O Estilo de Vida Saudável</h3>
                        <p>Cremos que nosso corpo é templo do Espírito Santo e defendemos um estilo de vida saudável, incluindo alimentação adequada, exercício físico e abstinência de substâncias nocivas.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-dove"></i> O Dom de Profecia</h3>
                        <p>Cremos que o dom de profecia foi manifestado no ministério de Ellen G. White, cujos escritos continuam a orientar e inspirar a igreja.</p>
                    </div>
                </div>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="commissions-section">
                <h2>Comissões e Departamentos</h2>
                <p style="text-align: center; margin-bottom: 1.8rem;">Selecione o tipo de comissão para acessar o sistema de atas correspondente:</p>
                
                <div class="commissions-grid">
                    <div class="commission-card" onclick="selectCommission('assembleia-geral')">
                        <i class="fas fa-users commission-icon"></i>
                        <h3>Assembleia Geral</h3>
                        <p>Reuniões com participação de todos os membros da igreja</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('diretoria')">
                        <i class="fas fa-user-tie commission-icon"></i>
                        <h3>Diretoria</h3>
                        <p>Reuniões da diretoria da igreja</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('comissao')">
                        <i class="fas fa-clipboard-list commission-icon"></i>
                        <h3>Comissões</h3>
                        <p>Reuniões de comissões específicas</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('secretaria')">
                        <i class="fas fa-file-alt commission-icon"></i>
                        <h3>Secretaria</h3>
                        <p>Reuniões do departamento de secretaria</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('tesouraria')">
                        <i class="fas fa-dollar-sign commission-icon"></i>
                        <h3>Tesouraria</h3>
                        <p>Reuniões do departamento financeiro</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('outra')">
                        <i class="fas fa-ellipsis-h commission-icon"></i>
                        <h3>Outras Reuniões</h3>
                        <p>Reuniões que não se enquadram nas categorias acima</p>
                    </div>
                </div>
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" onclick="showATASystem()">
                    <i class="fas fa-external-link-alt"></i> Acessar Sistema de ATAs
                </button>
                <button class="btn btn-secondary" onclick="showHistoryScreen()">
                    <i class="fas fa-history"></i> Ver Histórico de ATAs
                </button>
            </div>
        </div>
    </div>
    
    <!-- SISTEMA DE ATAS -->
    <div class="container screen" id="ata-system-screen">
        <button class="back-button" onclick="showHomeScreen()">
            <i class="fas fa-arrow-left"></i> Voltar para a Tela Inicial
        </button>
        
        <div class="card">
            <div class="tabs">
                <button class="tab active" data-tab="create">Criar ATA</button>
                <button class="tab" data-tab="history">Histórico</button>
                <button class="tab" data-tab="help">Ajuda</button>
            </div>
            
            <div class="tab-content active" id="create-tab">
                <h2>Criar Nova ATA</h2>
                
                <div class="form-group">
                    <label for="ataType">Tipo de ATA</label>
                    <select id="ataType">
                        <option value="">Selecione o tipo de ATA</option>
                        <option value="assembleia-geral">Assembleia Geral</option>
                        <option value="diretoria">Reunião de Diretoria</option>
                        <option value="comissao">Reunião de Comissão</option>
                        <option value="secretaria">Reunião de Secretaria</option>
                        <option value="tesouraria">Reunião de Tesouraria</option>
                        <option value="outra">Outra</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="ataNumber">Número da ATA</label>
                        <input type="text" id="ataNumber" placeholder="Ex: 001/2023">
                    </div>
                    
                    <div class="form-group">
                        <label for="ataDate">Data da Reunião</label>
                        <input type="date" id="ataDate">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ataLocation">Local da Reunião</label>
                    <input type="text" id="ataLocation" placeholder="Ex: Sala de Reuniões da Igreja" value="Igreja Adventista do Sétimo Dia">
                </div>
                
                <div class="form-group">
                    <label for="meetingTime">Horário da Reunião</label>
                    <input type="text" id="meetingTime" placeholder="Ex: 19:30 às 21:00">
                </div>

                <!-- NOVA SEÇÃO: ELEMENTOS DE ADORAÇÃO -->
                <div class="worship-section">
                    <h3><i class="fas fa-pray"></i> Elementos de Adoração</h3>
                    
                    <div class="form-group">
                        <label for="openingPrayer">Responsável pela Oração Inicial</label>
                        <input type="text" id="openingPrayer" placeholder="Nome da pessoa que fez a oração inicial">
                    </div>
                    
                    <div class="form-group">
                        <label for="bibleVerse">Versículo Base da Meditação</label>
                        <input type="text" id="bibleVerse" placeholder="Ex: João 3:16">
                    </div>
                    
                    <div class="form-group">
                        <label for="verseText">Texto do Versículo (Opcional)</label>
                        <textarea id="verseText" placeholder="Digite o texto completo do versículo"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Hinos Escolhidos</label>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <input type="text" id="hymnNumber" placeholder="Número do hino">
                            </div>
                            <div class="form-group" style="flex: 2;">
                                <input type="text" id="hymnTitle" placeholder="Título do hino">
                            </div>
                            <button class="btn btn-secondary" id="addHymn">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>
                        <div class="members-list" id="hymnsList">
                            <!-- Hinos serão adicionados aqui -->
                        </div>
                    </div>
                </div>
                
                <h3>Participantes</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="president">Presidente da Reunião</label>
                        <input type="text" id="president" placeholder="Nome do presidente">
                    </div>
                    
                    <div class="form-group">
                        <label for="secretary">Secretário da Reunião</label>
                        <input type="text" id="secretary" placeholder="Nome do secretário">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="participants">Lista de Participantes</label>
                    <div class="form-row">
                        <input type="text" id="newParticipant" placeholder="Nome do participante">
                        <button class="btn btn-secondary" id="addParticipant">Adicionar</button>
                    </div>
                    <div class="members-list" id="participantsList">
                        <!-- Participants will be added here -->
                    </div>
                </div>
                
                <h3>Pauta da Reunião</h3>
                
                <div class="form-group">
                    <label for="agendaItems">Itens da Pauta</label>
                    <textarea id="agendaItems" placeholder="Descreva os itens da pauta, um por linha"></textarea>
                </div>
                
                <h3>Deliberações</h3>
                
                <div class="form-group">
                    <label for="deliberations">Deliberações e Decisões</label>
                    <textarea id="deliberations" placeholder="Descreva as deliberações e decisões tomadas"></textarea>
                </div>
                
                <div class="actions system-actions">
                    <button class="btn btn-secondary" id="previewBtn">Visualizar ATA</button>
                    <button class="btn btn-primary" id="generateBtn">Gerar e Salvar ATA</button>
                </div>
                
                <div class="preview-container" id="previewContainer" style="display: none;">
                    <h3>Pré-visualização da ATA</h3>
                    <div class="ata-preview" id="ataPreview">
                        <!-- ATA preview will be generated here -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="history-tab">
                <h2>Histórico de ATAs</h2>
                
                <div class="history-list" id="historyList">
                    <!-- History items will be added here -->
                </div>
                
                <div class="empty-state" id="emptyHistory" style="display: none;">
                    <i class="fas fa-history"></i>
                    <h3>Nenhuma ATA encontrada</h3>
                    <p>As atas que você criar aparecerão aqui.</p>
                </div>
            </div>
            
            <div class="tab-content" id="help-tab">
                <h2>Ajuda e Instruções</h2>
                
                <h3>Como usar o sistema</h3>
                <p>Para criar uma nova ATA, siga os passos:</p>
                <ol>
                    <li>Selecione o tipo de ATA que deseja criar</li>
                    <li>Preencha os dados básicos da reunião (número, data, local, horário)</li>
                    <li>Preencha os elementos de adoração (oração, versículo, hinos)</li>
                    <li>Adicione os participantes da reunião</li>
                    <li>Descreva a pauta da reunião</li>
                    <li>Registre as deliberações e decisões tomadas</li>
                    <li>Visualize a ATA antes de gerar o documento final</li>
                    <li>Clique em "Gerar e Salvar ATA" para finalizar</li>
                </ol>
                
                <h3>Tipos de ATA</h3>
                <ul>
                    <li><strong>Assembleia Geral:</strong> Reuniões com a participação de todos os membros da igreja</li>
                    <li><strong>Reunião de Diretoria:</strong> Reuniões da diretoria da igreja</li>
                    <li><strong>Reunião de Comissão:</strong> Reuniões de comissões específicas</li>
                    <li><strong>Reunião de Secretaria:</strong> Reuniões do departamento de secretaria</li>
                    <li><strong>Reunião de Tesouraria:</strong> Reuniões do departamento financeiro</li>
                    <li><strong>Outra:</strong> Para reuniões que não se enquadram nas categorias acima</li>
                </ul>
                
                <h3>Recursos do Sistema</h3>
                <ul>
                    <li><strong>Histórico:</strong> Todas as ATAs criadas ficam salvas no histórico</li>
                    <li><strong>Download:</strong> É possível baixar as ATAs em formato Word</li>
                    <li><strong>Visualização:</strong> Pré-visualização da ATA antes de gerar</li>
                    <li><strong>Edição:</strong> Possibilidade de editar ATAs do histórico</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- TELA DE DÚVIDAS -->
    <div class="container screen" id="faq-screen">
        <button class="back-button" onclick="showHomeScreen()">
            <i class="fas fa-arrow-left"></i> Voltar para a Tela Inicial
        </button>
        
        <div class="card">
            <div class="intro-section">
                <h2>Dúvidas Frequentes</h2>
                <p>Encontre respostas para as perguntas mais comuns sobre o sistema de ATAs e a Igreja Adventista do Sétimo Dia.</p>
            </div>
            
            <div class="faq-section">
                <h2>Perguntas sobre o Sistema de ATAs</h2>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Como criar uma nova ATA?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Para criar uma nova ATA, acesse a seção "Criar ATA" no menu superior, selecione o tipo de reunião, preencha os dados básicos, adicione os participantes, descreva a pauta e as deliberações, e então clique em "Gerar e Salvar ATA".</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Posso editar uma ATA após gerá-la?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Sim, você pode editar ATAs existentes. Acesse o "Histórico" no sistema de ATAs, localize a ATA desejada e clique no botão "Editar". Após fazer as alterações, gere a ATA novamente para salvar as modificações.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Como faço para baixar uma ATA?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>No histórico de ATAs, ao lado de cada ATA listada, há um botão "Baixar". Clique nele para baixar a ATA em formato Word (.docx).</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Os dados ficam salvos onde?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os dados são armazenados localmente no seu navegador usando a tecnologia localStorage. Isso significa que as ATAs ficam salvas apenas no dispositivo onde foram criadas.</p>
                    </div>
                </div>
            </div>
            
            <div class="faq-section">
                <h2>Perguntas sobre a Igreja Adventista</h2>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Por que os adventistas guardam o sábado?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os adventistas guardam o sábado porque acreditam que ele é um memorial da criação estabelecido por Deus no sétimo dia (Gênesis 2:1-3) e confirmado nos Dez Mandamentos (Êxodo 20:8-11). É um dia especial de descanso, adoração e comunhão com Deus.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Qual é a visão adventista sobre a saúde?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os adventistas promovem um estilo de vida saudável baseado em princípios bíblicos, incluindo alimentação vegetariana, abstinência de álcool, tabaco e outras drogas, exercício físico adequado, confiança em Deus e equilíbrio entre trabalho e descanso.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>O que os adventistas creem sobre a segunda vinda de Cristo?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os adventistas creem na volta visível, pessoal e iminente de Jesus Cristo. Esta crença é central para sua fé e motiva sua missão de preparar pessoas para esse evento, através da proclamação do evangelho e do cuidado integral com as pessoas.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Qual é a estrutura organizacional da Igreja Adventista?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>A Igreja Adventista é organizada em uma estrutura representativa com quatro níveis: a igreja local, a associação/missão, a união e a Associação Geral. Cada nível tem autonomia em sua esfera de atuação, com líderes eleitos por delegados em assembleias regulares.</p>
                    </div>
                </div>
            </div>
            
            <div class="contact-form">
                <h3>Ainda tem dúvidas?</h3>
                <p>Se você não encontrou a resposta para sua pergunta, entre em contato conosco:</p>
                
                <div class="form-group">
                    <label for="contactName">Seu Nome</label>
                    <input type="text" id="contactName" placeholder="Digite seu nome">
                </div>
                
                <div class="form-group">
                    <label for="contactEmail">Seu E-mail</label>
                    <input type="email" id="contactEmail" placeholder="Digite seu e-mail">
                </div>
                
                <div class="form-group">
                    <label for="contactMessage">Sua Mensagem</label>
                    <textarea id="contactMessage" placeholder="Descreva sua dúvida ou questão" rows="5"></textarea>
                </div>
                
                <button class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Enviar Mensagem
                </button>
            </div>
        </div>
    </div>
    
    <footer>
        <p> ATA de Comissão - @2023</p>
    </footer>

    <script>
        // Variáveis globais
        let selectedCommission = '';
        let participants = [];
        let hymns = [];
        
        // Navegação entre telas
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // Atualizar botões de navegação
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ativar o botão correspondente à tela atual
            if (screenId === 'home-screen') {
                document.querySelector('.nav-btn[onclick="showHomeScreen()"]').classList.add('active');
            } else if (screenId === 'ata-system-screen') {
                document.querySelector('.nav-btn[onclick="showATASystem()"]').classList.add('active');
            } else if (screenId === 'faq-screen') {
                document.querySelector('.nav-btn[onclick="showFAQScreen()"]').classList.add('active');
            }
        }
        
        function showHomeScreen() {
            showScreen('home-screen');
            document.getElementById('subtitle').textContent = 'ATA Digital - Sistema de Registro de Atas';
        }
        
        function showATASystem() {
            if (!selectedCommission) {
                alert('Por favor, selecione um tipo de comissão antes de prosseguir.');
                return;
            }
            
            showScreen('ata-system-screen');
            document.getElementById('subtitle').textContent = 'Sistema de ATAs - ' + getCommissionName(selectedCommission);
            
            // Preencher automaticamente o tipo de ATA
            document.getElementById('ataType').value = selectedCommission;
            
            // Ir para a aba de criação
            document.querySelector('[data-tab="create"]').click();
        }
        
        function showFAQScreen() {
            showScreen('faq-screen');
            document.getElementById('subtitle').textContent = 'Dúvidas Frequentes';
        }
        
        function showHistoryScreen() {
            showScreen('ata-system-screen');
            document.querySelector('[data-tab="history"]').click();
            document.getElementById('subtitle').textContent = 'Histórico de ATAs';
        }
        
        // Seleção de comissão
        function selectCommission(commission) {
            selectedCommission = commission;
            
            // Update UI to show selected commission
            const cards = document.querySelectorAll('.commission-card');
            cards.forEach(card => {
                card.classList.remove('selected');
            });
            
            // Highlight selected card
            const selectedCard = document.querySelector(`[onclick="selectCommission('${commission}')"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
        }
        
        function getCommissionName(commission) {
            const commissionNames = {
                'assembleia-geral': 'Assembleia Geral',
                'diretoria': 'Reunião de Diretoria',
                'comissao': 'Reunião de Comissão',
                'secretaria': 'Reunião de Secretaria',
                'tesouraria': 'Reunião de Tesouraria',
                'outra': 'Outra Reunião'
            };
            
            return commissionNames[commission] || 'Reunião';
        }
        
        // ========== SISTEMA DE ATAS ==========
        
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar seleção padrão
            selectCommission('assembleia-geral');
            
            // Tab functionality
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show active tab content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    // If history tab, load history
                    if (tabId === 'history') {
                        loadHistory();
                    }
                });
            });
            
            // FAQ functionality
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    item.classList.toggle('active');
                });
            });
            
            // Participants functionality
            const addParticipantBtn = document.getElementById('addParticipant');
            const newParticipantInput = document.getElementById('newParticipant');
            const participantsList = document.getElementById('participantsList');
            
            addParticipantBtn.addEventListener('click', function() {
                const participantName = newParticipantInput.value.trim();
                if (participantName) {
                    addParticipant(participantName);
                    newParticipantInput.value = '';
                }
            });
            
            newParticipantInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addParticipantBtn.click();
                }
            });
            
            function addParticipant(name) {
                participants.push(name);
                renderParticipants();
            }
            
            function removeParticipant(index) {
                participants.splice(index, 1);
                renderParticipants();
            }
            
            function renderParticipants() {
                participantsList.innerHTML = '';
                
                if (participants.length === 0) {
                    participantsList.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 1rem;">Nenhum participante adicionado</p>';
                    return;
                }
                
                participants.forEach((participant, index) => {
                    const participantElement = document.createElement('div');
                    participantElement.className = 'member-item';
                    participantElement.innerHTML = `
                        <span>${participant}</span>
                        <div class="member-actions">
                            <button class="btn btn-secondary btn-sm" onclick="removeParticipant(${index})">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    participantsList.appendChild(participantElement);
                });
            }
            
            // Hinos functionality
            const addHymnBtn = document.getElementById('addHymn');
            const hymnNumberInput = document.getElementById('hymnNumber');
            const hymnTitleInput = document.getElementById('hymnTitle');
            const hymnsList = document.getElementById('hymnsList');
            
            addHymnBtn.addEventListener('click', function() {
                const hymnNumber = hymnNumberInput.value.trim();
                const hymnTitle = hymnTitleInput.value.trim();
                
                if (hymnNumber && hymnTitle) {
                    addHymn(hymnNumber, hymnTitle);
                    hymnNumberInput.value = '';
                    hymnTitleInput.value = '';
                } else {
                    alert('Por favor, preencha tanto o número quanto o título do hino.');
                }
            });
            
            hymnNumberInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addHymnBtn.click();
                }
            });
            
            hymnTitleInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addHymnBtn.click();
                }
            });
            
            function addHymn(number, title) {
                hymns.push({ number, title });
                renderHymns();
            }
            
            function removeHymn(index) {
                hymns.splice(index, 1);
                renderHymns();
            }
            
            function renderHymns() {
                hymnsList.innerHTML = '';
                
                if (hymns.length === 0) {
                    hymnsList.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 1rem;">Nenhum hino adicionado</p>';
                    return;
                }
                
                hymns.forEach((hymn, index) => {
                    const hymnElement = document.createElement('div');
                    hymnElement.className = 'hymn-item';
                    hymnElement.innerHTML = `
                        <div class="hymn-number">Hino ${hymn.number}</div>
                        <div class="hymn-title">${hymn.title}</div>
                        <div class="member-actions">
                            <button class="btn btn-secondary btn-sm" onclick="removeHymn(${index})">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `;
                    hymnsList.appendChild(hymnElement);
                });
            }
            
            // Initialize with empty lists
            renderParticipants();
            renderHymns();
            
            // Preview functionality
            const previewBtn = document.getElementById('previewBtn');
            const generateBtn = document.getElementById('generateBtn');
            const previewContainer = document.getElementById('previewContainer');
            const ataPreview = document.getElementById('ataPreview');
            
            previewBtn.addEventListener('click', function() {
                generatePreview();
                previewContainer.style.display = 'block';
            });
            
            function generatePreview() {
                const ataType = document.getElementById('ataType').value;
                const ataNumber = document.getElementById('ataNumber').value;
                const ataDate = document.getElementById('ataDate').value;
                const ataLocation = document.getElementById('ataLocation').value;
                const meetingTime = document.getElementById('meetingTime').value;
                const president = document.getElementById('president').value;
                const secretary = document.getElementById('secretary').value;
                const agendaItems = document.getElementById('agendaItems').value;
                const deliberations = document.getElementById('deliberations').value;
                const openingPrayer = document.getElementById('openingPrayer').value;
                const bibleVerse = document.getElementById('bibleVerse').value;
                const verseText = document.getElementById('verseText').value;
                
                // Format date
                const formattedDate = ataDate ? new Date(ataDate).toLocaleDateString('pt-BR') : '';
                
                // Format agenda items
                const agendaList = agendaItems.split('\n')
                    .filter(item => item.trim() !== '')
                    .map(item => `<li>${item}</li>`)
                    .join('');
                
                // Format hymns
                const hymnsList = hymns.map(hymn => 
                    `<li>Hino ${hymn.number} - ${hymn.title}</li>`
                ).join('');
                
                // Get type label
                const typeLabels = {
                    'assembleia-geral': 'Assembleia Geral',
                    'diretoria': 'Reunião de Diretoria',
                    'comissao': 'Reunião de Comissão',
                    'secretaria': 'Reunião de Secretaria',
                    'tesouraria': 'Reunião de Tesouraria',
                    'outra': 'Reunião'
                };
                
                const typeLabel = typeLabels[ataType] || 'Reunião';
                
                ataPreview.innerHTML = `
                    <div class="ata-header">
                        <div class="ata-title">ATA DE ${typeLabel.toUpperCase()}</div>
                        <div class="ata-subtitle">Nº ${ataNumber || '___/____'}</div>
                    </div>
                    
                    <div class="ata-body">
                        <p>Aos <strong>${formattedDate || '_____'}</strong>, às <strong>${meetingTime || '_____'}</strong>, 
                        na <strong>${ataLocation || '_____'}</strong>, reuniu-se a <strong>${typeLabel}</strong> 
                        da <strong>Igreja Adventista do Sétimo Dia</strong>, sob a presidência de 
                        <strong>${president || '_____'}</strong>, secretariada por 
                        <strong>${secretary || '_____'}</strong>.</p>
                        
                        <p>A reunião iniciou com uma oração feita por <strong>${openingPrayer || '_____'}</strong>, 
                        seguida pela meditação no versículo <strong>${bibleVerse || '_____'}</strong>${verseText ? `: "${verseText}"` : ''}.</p>
                        
                        <p>Foram entoados os seguintes hinos:
                            <ul>
                                ${hymnsList || '<li>_________________________________</li>'}
                            </ul>
                        </p>
                        
                        <p>Em seguida, foi tratada a seguinte pauta:</p>
                        
                        <ol>
                            ${agendaList || '<li>_________________________________</li>'}
                        </ol>
                        
                        <p>Foram discutidos os assuntos constantes da pauta e, após debates, foram tomadas as seguintes deliberações:</p>
                        
                        <p>${deliberations || '_________________________________________________________'}</p>
                        
                        <p>Nada mais havendo a tratar, foi encerrada a reunião e, para constar, foi lavrada a presente ata, que será assinada pelo presidente e secretário.</p>
                    </div>
                    
                    <div class="ata-signatures">
                        <div class="signature-line">
                            <strong>${president || '__________________________'}</strong><br>
                            Presidente
                        </div>
                        
                        <div class="signature-line">
                            <strong>${secretary || '__________________________'}</strong><br>
                            Secretário
                        </div>
                    </div>
                `;
            }
            
            // Generate and save ATA
            generateBtn.addEventListener('click', function() {
                const ataType = document.getElementById('ataType').value;
                const ataNumber = document.getElementById('ataNumber').value;
                const ataDate = document.getElementById('ataDate').value;
                
                if (!ataType || !ataNumber || !ataDate) {
                    alert('Por favor, preencha pelo menos o tipo, número e data da ATA.');
                    return;
                }
                
                // Generate ATA data
                const ataData = {
                    id: Date.now(),
                    type: ataType,
                    number: ataNumber,
                    date: ataDate,
                    location: document.getElementById('ataLocation').value,
                    time: document.getElementById('meetingTime').value,
                    president: document.getElementById('president').value,
                    secretary: document.getElementById('secretary').value,
                    openingPrayer: document.getElementById('openingPrayer').value,
                    bibleVerse: document.getElementById('bibleVerse').value,
                    verseText: document.getElementById('verseText').value,
                    hymns: hymns,
                    participants: participants,
                    agenda: document.getElementById('agendaItems').value,
                    deliberations: document.getElementById('deliberations').value,
                    createdAt: new Date().toISOString()
                };
                
                // Save to localStorage
                saveATA(ataData);
                
                // Generate and download Word document
                downloadATAasWord(ataData);
                
                // Show success message
                alert('ATA gerada e salva com sucesso! O arquivo Word será baixado automaticamente.');
                
                // Reset form
                resetForm();
                
                // Switch to history tab
                document.querySelector('[data-tab="history"]').click();
            });
            
            function saveATA(ataData) {
                let atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                atas.push(ataData);
                localStorage.setItem('adventist-atas', JSON.stringify(atas));
            }
            
            function loadHistory() {
                const historyList = document.getElementById('historyList');
                const emptyHistory = document.getElementById('emptyHistory');
                
                let atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                
                historyList.innerHTML = '';
                
                if (atas.length === 0) {
                    emptyHistory.style.display = 'block';
                    return;
                }
                
                emptyHistory.style.display = 'none';
                
                // Sort by date (newest first)
                atas.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                atas.forEach(ata => {
                    const typeLabels = {
                        'assembleia-geral': 'Assembleia Geral',
                        'diretoria': 'Reunião de Diretoria',
                        'comissao': 'Reunião de Comissão',
                        'secretaria': 'Reunião de Secretaria',
                        'tesouraria': 'Reunião de Tesouraria',
                        'outra': 'Reunião'
                    };
                    
                    const formattedDate = new Date(ata.date).toLocaleDateString('pt-BR');
                    const createdDate = new Date(ata.createdAt).toLocaleDateString('pt-BR');
                    
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div class="history-info">
                            <div class="history-title">ATA ${ata.number} - ${typeLabels[ata.type]}</div>
                            <div class="history-details">
                                Realizada em ${formattedDate} | Criada em ${createdDate} | 
                                ${ata.participants.length} participantes | ${ata.hymns.length} hinos
                            </div>
                        </div>
                        <div class="history-actions">
                            <button class="btn btn-secondary" onclick="viewATA(${ata.id})">
                                <i class="fas fa-eye"></i> Ver
                            </button>
                            <button class="btn btn-primary" onclick="downloadATAFromHistory(${ata.id})">
                                <i class="fas fa-download"></i> Baixar
                            </button>
                            <button class="btn btn-secondary" onclick="editATA(${ata.id})">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="btn btn-secondary" onclick="deleteATA(${ata.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    historyList.appendChild(historyItem);
                });
            }
            
            function resetForm() {
                document.getElementById('ataType').value = selectedCommission;
                document.getElementById('ataNumber').value = '';
                document.getElementById('ataDate').value = '';
                document.getElementById('ataLocation').value = 'Igreja Adventista do Sétimo Dia';
                document.getElementById('meetingTime').value = '';
                document.getElementById('president').value = '';
                document.getElementById('secretary').value = '';
                document.getElementById('openingPrayer').value = '';
                document.getElementById('bibleVerse').value = '';
                document.getElementById('verseText').value = '';
                document.getElementById('agendaItems').value = '';
                document.getElementById('deliberations').value = '';
                participants = [];
                hymns = [];
                renderParticipants();
                renderHymns();
                previewContainer.style.display = 'none';
            }
            
            // Download ATA as Word document
            function downloadATAasWord(ataData) {
                const typeLabels = {
                    'assembleia-geral': 'Assembleia Geral',
                    'diretoria': 'Reunião de Diretoria',
                    'comissao': 'Reunião de Comissão',
                    'secretaria': 'Reunião de Secretaria',
                    'tesouraria': 'Reunião de Tesouraria',
                    'outra': 'Reunião'
                };
                
                const formattedDate = new Date(ataData.date).toLocaleDateString('pt-BR');
                
                // Create Word document content
                let content = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head>
                    <meta charset="utf-8">
                    <title>ATA ${ataData.number}</title>
                    <style>
                        body {
                            font-family: 'Times New Roman', serif;
                            font-size: 12pt;
                            line-height: 1.5;
                            margin: 1in;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 40px;
                        }
                        .title {
                            font-size: 16pt;
                            font-weight: bold;
                            margin-bottom: 10px;
                        }
                        .subtitle {
                            font-size: 14pt;
                            margin-bottom: 30px;
                        }
                        .body {
                            text-align: justify;
                            margin-bottom: 30px;
                        }
                        .signatures {
                            display: flex;
                            justify-content: space-between;
                            margin-top: 60px;
                        }
                        .signature-line {
                            border-top: 1px solid #000;
                            width: 220px;
                            text-align: center;
                            padding-top: 5px;
                        }
                        ul, ol {
                            margin-left: 40px;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="title">ATA DE ${typeLabels[ataData.type].toUpperCase()}</div>
                        <div class="subtitle">Nº ${ataData.number}</div>
                    </div>
                    
                    <div class="body">
                        <p>Aos <strong>${formattedDate}</strong>, às <strong>${ataData.time}</strong>, 
                        na <strong>${ataData.location}</strong>, reuniu-se a <strong>${typeLabels[ataData.type]}</strong> 
                        da <strong>Igreja Adventista do Sétimo Dia</strong>, sob a presidência de 
                        <strong>${ataData.president}</strong>, secretariada por 
                        <strong>${ataData.secretary}</strong>.</p>
                        
                        <p>A reunião iniciou com uma oração feita por <strong>${ataData.openingPrayer}</strong>, 
                        seguida pela meditação no versículo <strong>${ataData.bibleVerse}</strong>${ataData.verseText ? `: "${ataData.verseText}"` : ''}.</p>
                        
                        <p>Foram entoados os seguintes hinos:</p>
                        <ul>
                `;
                
                // Add hymns
                if (ataData.hymns && ataData.hymns.length > 0) {
                    ataData.hymns.forEach(hymn => {
                        content += `<li>Hino ${hymn.number} - ${hymn.title}</li>`;
                    });
                } else {
                    content += `<li>_________________________________</li>`;
                }
                
                content += `
                        </ul>
                        
                        <p>Em seguida, foi tratada a seguinte pauta:</p>
                        <ol>
                `;
                
                // Add agenda items
                if (ataData.agenda) {
                    const agendaItems = ataData.agenda.split('\n').filter(item => item.trim() !== '');
                    agendaItems.forEach(item => {
                        content += `<li>${item}</li>`;
                    });
                } else {
                    content += `<li>_________________________________</li>`;
                }
                
                content += `
                        </ol>
                        
                        <p>Foram discutidos os assuntos constantes da pauta e, após debates, foram tomadas as seguintes deliberações:</p>
                        
                        <p>${ataData.deliberations || '_________________________________________________________'}</p>
                        
                        <p>Participantes da reunião:</p>
                        <ul>
                `;
                
                // Add participants
                if (ataData.participants && ataData.participants.length > 0) {
                    ataData.participants.forEach(participant => {
                        content += `<li>${participant}</li>`;
                    });
                } else {
                    content += `<li>_________________________________</li>`;
                }
                
                content += `
                        </ul>
                        
                        <p>Nada mais havendo a tratar, foi encerrada a reunião e, para constar, foi lavrada a presente ata, que será assinada pelo presidente e secretário.</p>
                    </div>
                    
                    <div class="signatures">
                        <div class="signature-line">
                            <strong>${ataData.president}</strong><br>
                            Presidente
                        </div>
                        
                        <div class="signature-line">
                            <strong>${ataData.secretary}</strong><br>
                            Secretário
                        </div>
                    </div>
                </body>
                </html>
                `;
                
                // Create and download the Word document
                const blob = new Blob([content], { type: 'application/msword' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ATA-${ataData.number}-${formattedDate.replace(/\//g, '-')}.doc`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            // Make functions available globally for onclick handlers
            window.removeParticipant = removeParticipant;
            window.removeHymn = removeHymn;
            window.viewATA = function(id) {
                const atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                const ata = atas.find(a => a.id === id);
                if (ata) {
                    alert(`Visualizando ATA ${ata.number}. Em uma implementação real, isso abriria uma visualização detalhada.`);
                }
            };
            
            window.downloadATAFromHistory = function(id) {
                const atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                const ata = atas.find(a => a.id === id);
                if (ata) {
                    downloadATAasWord(ata);
                }
            };
            
            window.editATA = function(id) {
                const atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                const ata = atas.find(a => a.id === id);
                if (ata) {
                    // Switch to create tab
                    document.querySelector('[data-tab="create"]').click();
                    
                    // Fill form with ATA data
                    document.getElementById('ataType').value = ata.type;
                    document.getElementById('ataNumber').value = ata.number;
                    document.getElementById('ataDate').value = ata.date;
                    document.getElementById('ataLocation').value = ata.location;
                    document.getElementById('meetingTime').value = ata.time;
                    document.getElementById('president').value = ata.president;
                    document.getElementById('secretary').value = ata.secretary;
                    document.getElementById('openingPrayer').value = ata.openingPrayer || '';
                    document.getElementById('bibleVerse').value = ata.bibleVerse || '';
                    document.getElementById('verseText').value = ata.verseText || '';
                    document.getElementById('agendaItems').value = ata.agenda;
                    document.getElementById('deliberations').value = ata.deliberations;
                    participants = ata.participants;
                    hymns = ata.hymns || [];
                    renderParticipants();
                    renderHymns();
                    
                    alert('ATA carregada para edição. Lembre-se de gerar novamente após as alterações.');
                }
            };
            
            window.deleteATA = function(id) {
                if (confirm('Tem certeza que deseja excluir esta ATA?')) {
                    let atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                    atas = atas.filter(a => a.id !== id);
                    localStorage.setItem('adventist-atas', JSON.stringify(atas));
                    loadHistory();
                }
            };
        });
    </script>
</body>
</html>