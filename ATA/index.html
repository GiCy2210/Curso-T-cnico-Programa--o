<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Igreja Adventista - ATA Digital</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        /* Mantendo todos os estilos anteriores */
        :root {
            --primary: #3a6447;
            --primary-dark: #3e6c3c;
            --primary-light: #54bc75;
            --secondary: #ac3838;
            --secondary-light: #b30000;
            --light: #f8faf9;
            --dark: #343a40;
            --gray: #728476;
            --gray-light: #e9efeb;
            --success: #28a745;
            --border: #dee6de;
            --gold: #d4af37;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.18);
            --gradient-primary: linear-gradient(135deg, var(--primary), var(--primary-dark));
            --gradient-secondary: linear-gradient(135deg, var(--secondary), var(--secondary-light));
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
            background-color: rgba(208, 255, 200, 0.498)
        }
        
        /* Barra de navegação superior */
        .top-nav {
            background: var(--gradient-primary);
            padding: 0.8rem 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .nav-logo i {
            font-size: 1.5rem;
        }
        
        .nav-buttons {
            display: flex;
            gap: 1rem;
        }
        
        .nav-btn {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: none;
            padding: 0.7rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }
        
        .nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        header {
            background: url('https://img.freepik.com/fotos-gratis/jovens-a-relaxar-juntos_23-2151561975.jpg?semt=ais_hybrid&w=740&q=80');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: rgb(255, 255, 255);
            padding: 2.5rem 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
            position: relative;
            min-height: 380px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.3) 100%);
            z-index: 1;
        }
        
        .header-content {
            max-width: 800px;
            z-index: 2;
            position: relative;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .logo {
            font-size: 3.5rem;
            color: white;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            background: rgba(255, 255, 255, 0.15);
            width: 90px;
            height: 90px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.4rem;
            opacity: 0.95;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.4);
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .header-text {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.95;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 2.5rem auto;
            padding: 0 1.5rem;
        }
        
        .card {
            background: rgb(255, 255, 255);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2.5rem;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        /* Estilos da tela inicial */
        .intro-section {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }
        
        .intro-section::after {
            content: '';
            display: block;
            width: 100px;
            height: 4px;
            background: var(--gradient-primary);
            margin: 1.5rem auto;
            border-radius: 2px;
        }
        
        .intro-section h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .intro-section p {
            max-width: 800px;
            margin: 0 auto 1.5rem;
            font-size: 1.15rem;
            line-height: 1.7;
        }
        
        .doctrines-section {
            margin-bottom: 2.5rem;
        }
        
        .doctrines-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .doctrines-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.8rem;
        }
        
        .doctrine-card {
            background: linear-gradient(145deg, #d0ffc8, #86c787bd);
            border-radius: 12px;
            padding: 1.8rem;
            border-left: 5px solid var(--primary);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }
        
        .doctrine-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }
        
        .doctrine-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
            color: white;
        }
        
        .doctrine-card:hover::before {
            opacity: 1;
        }
        
        .doctrine-card:hover h3,
        .doctrine-card:hover p,
        .doctrine-card:hover i {
            color: white;
            position: relative;
            z-index: 1;
        }
        
        .doctrine-card h3 {
            color: var(--primary-dark);
            margin-bottom: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            font-size: 1.3rem;
            transition: color 0.3s ease;
        }
        
        .doctrine-card h3 i {
            color: var(--secondary);
            transition: color 0.3s ease;
        }
        
        .doctrine-card p {
            transition: color 0.3s ease;
        }
        
        .commissions-section {
            margin-bottom: 2.5rem;
        }
        
        .commissions-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .commissions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.8rem;
        }
        
        .commission-card {
            background: rgb(207, 245, 224);
            border-radius: 12px;
            padding: 2rem 1.5rem;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.4s ease;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }
        
        .commission-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 0;
        }
        
        .commission-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            color: white;
        }
        
        .commission-card:hover::before {
            opacity: 1;
        }
        
        .commission-card:hover h3,
        .commission-card:hover p,
        .commission-card:hover .commission-icon {
            color: white;
            position: relative;
            z-index: 1;
        }
        
        .commission-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1.2rem;
            transition: color 0.4s ease;
        }
        
        .commission-card h3 {
            color: var(--primary-dark);
            margin-bottom: 0.8rem;
            font-size: 1.3rem;
            transition: color 0.4s ease;
        }
        
        .commission-card p {
            transition: color 0.4s ease;
        }
        
        /* Estilos do sistema de ATAs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 2rem;
            background: var(--gray-light);
            border-radius: 8px 8px 0 0;
            padding: 0.5rem;
        }
        
        .tab {
            padding: 0.9rem 1.8rem;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            border-radius: 6px;
            transition: all 0.3s ease;
            margin-right: 0.5rem;
        }
        
        .tab.active {
            color: white;
            background: var(--gradient-primary);
            box-shadow: 0 4px 10px rgba(44, 90, 160, 0.3);
        }
        
        .tab:hover:not(.active) {
            background: rgba(44, 90, 160, 0.1);
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        h2 {
            font-size: 1.8rem;
            margin-bottom: 1.2rem;
            color: var(--primary);
            font-weight: 700;
        }
        
        h3 {
            font-size: 1.4rem;
            margin: 1.8rem 0 1.2rem;
            color: var(--primary-dark);
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 0.6rem;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 1.8rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.6rem;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.2);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 1.2rem;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            padding: 0.9rem 1.8rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.7rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(44, 90, 160, 0.4);
        }
        
        .btn-secondary {
            background: #e9ecef;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #dee2e6;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4);
        }
        
        .btn-sm {
            padding: 0.6rem 1.2rem;
            font-size: 0.875rem;
        }
        
        .actions {
            display: flex;
            gap: 1.2rem;
            justify-content: center;
            margin-top: 2.5rem;
        }
        
        .system-actions {
            justify-content: flex-end;
        }
        
        .members-list {
            margin-top: 1.2rem;
        }
        
        .member-item {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.9rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .member-item:hover {
            background: var(--gray-light);
            transform: translateX(5px);
        }
        
        .member-actions {
            margin-left: auto;
            display: flex;
            gap: 0.6rem;
        }
        
        .history-list {
            list-style: none;
        }
        
        .history-item {
            padding: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .history-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .history-info {
            flex: 1;
        }
        
        .history-title {
            font-weight: 700;
            margin-bottom: 0.4rem;
            color: var(--primary-dark);
            font-size: 1.1rem;
        }
        
        .history-details {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .history-actions {
            display: flex;
            gap: 0.6rem;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }
        
        footer {
            text-align: center;
            padding: 2.5rem;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid var(--border);
            margin-top: 3rem;
            background: white;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .system-actions {
                flex-direction: column;
            }
            
            .history-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1.2rem;
            }
            
            .history-actions {
                align-self: flex-end;
            }
            
            .doctrines-grid,
            .commissions-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                min-height: 320px;
                padding: 2rem 1rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }
            
            .logo {
                font-size: 2.8rem;
                width: 70px;
                height: 70px;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1;
                min-width: 120px;
                margin-bottom: 0.5rem;
            }
            
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-buttons {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
        }
        
        .preview-container {
            background: #f8f9fa;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin-top: 1.8rem;
            max-height: 500px;
            overflow-y: auto;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .ata-preview {
            background: white;
            padding: 2.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            font-family: 'Times New Roman', serif;
            line-height: 1.8;
            border: 1px solid #e0e0e0;
        }
        
        .ata-header {
            text-align: center;
            margin-bottom: 2.5rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 1.5rem;
        }
        
        .ata-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 1.2rem;
            color: var(--primary-dark);
        }
        
        .ata-subtitle {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: var(--primary);
        }
        
        .ata-body {
            margin-bottom: 2.5rem;
        }
        
        .ata-signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 3.5rem;
        }
        
        .signature-line {
            border-top: 1px solid #000;
            width: 220px;
            text-align: center;
            padding-top: 0.8rem;
        }
        
        /* Navegação entre telas */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        .back-button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            margin-bottom: 1.5rem;
            padding: 0.7rem 0;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            color: var(--primary-dark);
            transform: translateX(-5px);
        }
        
        /* Novos estilos para os campos de hinos, oração e versículo */
        .hymn-item {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 0.9rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.9rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .hymn-item:hover {
            background: var(--gray-light);
            transform: translateX(5px);
        }
        
        .hymn-number {
            font-weight: bold;
            color: var(--primary);
            min-width: 70px;
            background: var(--gray-light);
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            text-align: center;
        }
        
        .hymn-title {
            flex: 1;
        }
        
        .worship-section {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 1.8rem;
            border-left: 5px solid var(--primary-dark);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        
        .worship-section h3 {
            color: var(--secondary);
            border-bottom: none;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        
        .worship-section h3 i {
            color: var(--secondary);
        }
        
        /* Decorative elements */
        .section-divider {
            height: 4px;
            width: 100px;
            background: var(--gradient-primary);
            margin: 2rem auto;
            border-radius: 2px;
        }
        
        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            z-index: 0;
        }
        
        .floating-element {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
            }
            100% {
                transform: translateY(0) rotate(360deg);
            }
        }
        
        /* Selection state for commission cards */
        .commission-card.selected {
            border: 2px solid var(--primary);
            background: var(--primary);
            color: white;
        }
        
        .commission-card.selected h3,
        .commission-card.selected p,
        .commission-card.selected .commission-icon {
            color: white;
        }
        
        /* Estilos para a tela de dúvidas */
        .faq-section {
            margin-bottom: 2.5rem;
        }
        
        .faq-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .faq-item {
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .faq-question {
            background: var(--gray-light);
            padding: 1.2rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .faq-question:hover {
            background: #dee2e6;
        }
        
        .faq-answer {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid var(--border);
            display: none;
        }
        
        .faq-item.active .faq-answer {
            display: block;
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .contact-form {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 2rem;
            border-radius: 12px;
            margin-top: 2rem;
            border-left: 5px solid var(--primary-dark);
        }
        
        .contact-form h3 {
            color: var(--primary);
            border-bottom: none;
            margin-top: 0;
        }

        /* Novos estilos para o formulário de deliberações */
        .deliberation-item {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .deliberation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .deliberation-number {
            font-weight: bold;
            color: var(--primary);
            background: var(--gray-light);
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
        }
        
        .deliberation-actions {
            display: flex;
            gap: 0.6rem;
        }
        
        .deliberation-content {
            margin-bottom: 1rem;
        }
        
        .deliberation-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
        }
        
        .deliberation-description {
            color: var(--dark);
            line-height: 1.6;
        }
        
        .voto-types {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .voto-type {
            background: var(--gray-light);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .voto-type:hover {
            background: var(--primary-light);
            color: white;
        }
        
        .voto-type.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
        }
        
        .voto-type h4 {
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .voto-type p {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        /* Estilo para o aviso de confidencialidade */
        .confidential-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            color: #856404;
        }
        
        .confidential-notice h4 {
            color: #856404;
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
        }
        
        .confidential-notice p {
            margin-bottom: 0.5rem;
        }

        /* NOVOS ESTILOS PARA CAMPOS ESPECÍFICOS DE VOTOS */
        .voto-fields {
            background: #f8f9fa;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
            display: none;
        }
        
        .voto-fields.active {
            display: block;
        }
        
        .voto-field-group {
            margin-bottom: 1rem;
        }
        
        .voto-field-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .voto-field-group input,
        .voto-field-group textarea,
        .voto-field-group select {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .voto-field-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .voto-participants {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .voto-participant-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: white;
            border: 1px solid var(--border);
            border-radius: 4px;
        }
        
        .voto-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .voto-table th,
        .voto-table td {
            border: 1px solid var(--border);
            padding: 0.7rem;
            text-align: left;
        }
        
        .voto-table th {
            background: var(--gray-light);
            font-weight: 600;
        }
        
        .relatorio-section {
            background: linear-gradient(145deg, #e3f2fd, #bbdefb);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            border-left: 5px solid #1976d2;
        }
        
        .relatorio-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .relatorio-field-group {
            margin-bottom: 1rem;
        }
        
        .relatorio-field-group.full-width {
            grid-column: 1 / -1;
        }
        
        .relatorio-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: white;
        }
        
        .relatorio-table th,
        .relatorio-table td {
            border: 1px solid var(--border);
            padding: 0.8rem;
            text-align: left;
        }
        
        .relatorio-table th {
            background: var(--primary-light);
            color: white;
            font-weight: 600;
        }
        
        .add-participant-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 0.5rem;
        }
        
        .remove-participant-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
            margin-left: auto;
        }
    </style>
</head>
<body>
    <!-- Barra de navegação superior -->
    <div class="top-nav">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-church"></i>
                <span>Igreja Adventista</span>
            </div>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showHomeScreen()">
                    <i class="fas fa-home"></i> Início
                </button>
                <button class="nav-btn" onclick="showATASystem()">
                    <i class="fas fa-file-alt"></i> Criar ATA
                </button>
                <button class="nav-btn" onclick="showFAQScreen()">
                    <i class="fas fa-question-circle"></i> Dúvidas
                </button>
            </div>
        </div>
    </div>
    
    <header>
        <div class="floating-elements">
            <div class="floating-element" style="width: 80px; height: 80px; top: 10%; left: 5%;"></div>
            <div class="floating-element" style="width: 60px; height: 60px; top: 70%; left: 80%;"></div>
            <div class="floating-element" style="width: 100px; height: 100px; top: 40%; left: 90%;"></div>
            <div class="floating-element" style="width: 50px; height: 50px; top: 20%; left: 70%;"></div>
        </div>
        
        <div class="header-content">
            <div class="logo-container">
                <i class="fas fa-church logo"></i>
                <div>
                    <h1>Igreja Adventista do Sétimo Dia</h1>
                    <p class="subtitle" id="subtitle">ATA Digital - Sistema de Registro de Atas</p>
                </div>
            </div>
            <p class="header-text">Sistema digital para criação e gerenciamento de atas de reuniões e assembleias da igreja</p>
        </div>
    </header>
    
    <!-- TELA INICIAL -->
    <div class="container screen active" id="home-screen">
        <div class="card">
            <div class="intro-section">
                <h2>Bem-vindo ao Sistema ATA Digital</h2>
                <p>Este é um Site próprio para a ATA da igeja Adventista, pois esta baseado em suas doutrinas, suas reuniões, sua estrutura administrativa, entre outras coisas. Ele foi criado com o intuito de facilitar e melhorar o funcionamento das Comissões, trazendo a ATA física para a digital.</p>
                <p>Nele, encontrará funções para te auxiliar na criação, com um passo a passo explicando como criar, baixar e editar. Nele pode encontrar acréscimos, como nossas principais doutrinas e algumas curiosidade sobre nossa igreja.</p>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="doctrines-section">
                <h2>Doutrinas Principais</h2>
                <div class="doctrines-grid">
                    <div class="doctrine-card">
                        <h3><i class="fas fa-bible"></i> As Escrituras Sagradas</h3>
                        <p>As Escrituras Sagradas, o Antigo e o Novo Testamento, são a Palavra de Deus escrita, dada por inspiração divina por intermédio de santos homens de Deus que falaram e escreveram ao serem movidos pelo Espírito Santo.</p>
                    </div>
                   
                    <div class="doctrine-card">
                        <h3><i class="fas fa-calendar-day"></i> O Sábado Sagrado</h3>
                        <p>O bondoso Criador, após os seis dias da Criação descansou no sétimo e instituiu o Sábado para todas as pessoas, como memorial da Criação. O quarto mandamento da imutável Lei de Deus requer a observância desse Sábado do sétimo dia como dia de descanso, adoração e ministério.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-undo-alt"></i> A Segunda Vinda de Cristo</h3>
                        <p>Cristo ministra em um santuário no Céu, aplicando aos crentes os méritos de Seu sacrifício na cruz. Ao ascender, tornou-Se o Sumo Sacerdote e iniciou Seu ministério intercessório.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-tint"></i> O Batismo por Imersão</h3>
                        <p>Pelo batismo confessamos nossa fé na morte e na ressurreição de Jesus Cristo e atestamos nossa morte para o pecado e nosso propósito de andar em novidade de vida, sendo aceitos como membros por Sua Igreja.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-heartbeat"></i> O Ministério de Cristo no Santuário Celestial</h3>
                        <p>Cristo ministra em um santuário no Céu, aplicando aos crentes os méritos de Seu sacrifício na cruz. Em 1844, começou a última fase desse ministério — o juízo investigativo — que revela quem será salvo.</p>
                    </div>
                    
                    <div class="doctrine-card">
                        <h3><i class="fas fa-dove"></i> O Dom de Profecia</h3>
                        <p>Um dos dons do Espírito Santo é a profecia. Esse dom é uma característica da Igreja remanescente e foi manifestado no ministério de Ellen G. White. Como a mensageira do Senhor, seus escritos são uma contínua e autorizada fonte de verdade.</p>
                    </div>
                </div>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="commissions-section">
                <h2>Comissões e Departamentos</h2>
                <p style="text-align: center; margin-bottom: 1.8rem;">Selecione o tipo de comissão para acessar o sistema de atas correspondente:</p>
                
                <div class="commissions-grid">
                    <div class="commission-card" onclick="selectCommission('comissao-diretiva')">
                        <i class="fas fa-users commission-icon"></i>
                        <h3>Comissão Diretiva</h3>
                        <p>Reuniões da comissão diretiva da igreja</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('reuniao-regular')">
                        <i class="fas fa-user-tie commission-icon"></i>
                        <h3>Reunião Regular</h3>
                        <p>Reuniões regulares da igreja</p>
                    </div>
                    
                    <div class="commission-card" onclick="selectCommission('reuniao-administrativa')">
                        <i class="fas fa-clipboard-list commission-icon"></i>
                        <h3>Reunião Administrativa</h3>
                        <p>Reuniões administrativas da igreja</p>
                    </div>
                </div>
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" onclick="showATASystem()">
                    <i class="fas fa-external-link-alt"></i> Acessar Sistema de ATAs
                </button>
                <button class="btn btn-secondary" onclick="showHistoryScreen()">
                    <i class="fas fa-history"></i> Ver Histórico de ATAs
                </button>
            </div>
        </div>
    </div>
    
    <!-- SISTEMA DE ATAS -->
    <div class="container screen" id="ata-system-screen">
        <button class="back-button" onclick="showHomeScreen()">
            <i class="fas fa-arrow-left"></i> Voltar para a Tela Inicial
        </button>
        
        <div class="card">
            <div class="tabs">
                <button class="tab active" data-tab="create">Criar ATA</button>
                <button class="tab" data-tab="history">Histórico</button>
                <button class="tab" data-tab="help">Ajuda</button>
            </div>
            
            <div class="tab-content active" id="create-tab">
                <h2>Criar Nova ATA</h2>
                
                <div class="confidential-notice">
                    <h4><i class="fas fa-shield-alt"></i> DOCUMENTO CONFIDENCIAL</h4>
                    <p><strong>ATENÇÃO:</strong> Todo o conteúdo desta ata está sob a proteção da lei, e a divulgação de qualquer nome, dado, número, decisão, ou de qualquer informação nela contida não poderá ser realizada por qualquer meio físico ou digital, sem a autorização expressa da Associação Paulista Sudoeste dos Adventistas do Sétimo Dia. A pessoa física ou jurídica que violar essa confidencialidade estará sujeita a sanções administrativas, cíveis e penais.</p>
                </div>
                
                <div class="form-group">
                    <label for="ataType">Tipo de ATA</label>
                    <select id="ataType">
                        <option value="">Selecione o tipo de ATA</option>
                        <option value="comissao-diretiva">Comissão Diretiva</option>
                        <option value="reuniao-regular">Reunião Regular</option>
                        <option value="reuniao-administrativa">Reunião Administrativa</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="ataNumber">Número da ATA</label>
                        <input type="text" id="ataNumber" placeholder="Ex: 001/2023">
                    </div>
                    
                    <div class="form-group">
                        <label for="ataDate">Data da Reunião</label>
                        <input type="date" id="ataDate">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="igrejaNome">Nome da Igreja</label>
                    <input type="text" id="igrejaNome" placeholder="Ex: Igreja Adventista do Sétimo Dia de Jardim do Céu">
                </div>
                
                <div class="form-group">
                    <label for="igrejaEndereco">Endereço da Igreja</label>
                    <input type="text" id="igrejaEndereco" placeholder="Ex: Rua Nova Jerusalém, 555">
                </div>
                
                <div class="form-group">
                    <label for="meetingTime">Horário da Reunião</label>
                    <input type="text" id="meetingTime" placeholder="Ex: 19 horas">
                </div>

                <!-- SEÇÃO: ELEMENTOS DE ADORAÇÃO -->
                <div class="worship-section">
                    <h3><i class="fas fa-pray"></i> Elementos de Adoração</h3>
                    
                    <div class="form-group">
                        <label for="hino">Hino</label>
                        <input type="text" id="hino" placeholder="Ex: 469 HÁ - Oh! Que Esperança!">
                    </div>
                    
                    <div class="form-group">
                        <label for="oracao">Oração</label>
                        <input type="text" id="oracao" placeholder="Nome da pessoa que fez a oração">
                    </div>
                    
                    <div class="form-group">
                        <label for="reflexao">Reflexão Bíblica</label>
                        <input type="text" id="reflexao" placeholder="Nome da pessoa que fez a reflexão bíblica">
                    </div>
                </div>
                
                <h3>Participantes</h3>
                
                <div class="form-group">
                    <label for="membrosPresentes">Membros Presentes</label>
                    <textarea id="membrosPresentes" placeholder="Lista de membros presentes, separados por vírgula"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="convidados">Convidados</label>
                    <textarea id="convidados" placeholder="Lista de convidados, separados por vírgula"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="presidente">Presidente da Reunião</label>
                        <input type="text" id="presidente" placeholder="Nome do presidente">
                    </div>
                    
                    <div class="form-group">
                        <label for="secretario">Secretário da Reunião</label>
                        <input type="text" id="secretario" placeholder="Nome do secretário">
                    </div>
                </div>

                <!-- NOVA SEÇÃO: DELIBERAÇÕES COM CAMPOS ESPECÍFICOS -->
                <h3>Deliberações</h3>
                <p>Adicione as deliberações da reunião. Selecione o tipo de voto para ver campos específicos.</p>
                
                <div class="form-group">
                    <label for="deliberationTitle">Título da Deliberação</label>
                    <input type="text" id="deliberationTitle" placeholder="Ex: VOZ E VOTO - CONVIDADO - CONCEDER">
                </div>
                
                <div class="form-group">
                    <label for="deliberationDescription">Descrição da Deliberação</label>
                    <textarea id="deliberationDescription" placeholder="Descreva a deliberação em detalhes"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Tipo de Voto</label>
                    <div class="voto-types">
                        <div class="voto-type" data-voto="001" onclick="selectVotoType(this)">
                            <h4>001 - VOZ E VOTO</h4>
                            <p>Conceder direito a voz e voto a convidado</p>
                        </div>
                        <div class="voto-type" data-voto="002" onclick="selectVotoType(this)">
                            <h4>002 - CLASSIFICAÇÃO DE MEMBROS</h4>
                            <p>Registrar classificação de membros</p>
                        </div>
                        <div class="voto-type" data-voto="014" onclick="selectVotoType(this)">
                            <h4>014 - ADMISSÃO DE MEMBROS</h4>
                            <p>Recomendar admissão de membros</p>
                        </div>
                        <div class="voto-type" data-voto="015" onclick="selectVotoType(this)">
                            <h4>015 - CARTAS DE TRANSFERÊNCIA</h4>
                            <p>Recomendar cartas de transferência</p>
                        </div>
                        <div class="voto-type" data-voto="020" onclick="selectVotoType(this)">
                            <h4>020 - ASSEMBLEIA DA ASSOCIAÇÃO</h4>
                            <p>Delegado para assembleia</p>
                        </div>
                        <div class="voto-type" data-voto="075" onclick="selectVotoType(this)">
                            <h4>075 - ORÇAMENTO DA IGREJA</h4>
                            <p>Aprovar orçamento da igreja</p>
                        </div>
                    </div>
                </div>

                <!-- CAMPOS ESPECÍFICOS PARA CADA TIPO DE VOTO -->
                <div id="votoFieldsContainer">
                    <!-- Campos serão inseridos aqui dinamicamente -->
                </div>

                <!-- SEÇÃO DE RELATÓRIO -->
                <div class="relatorio-section">
                    <h3><i class="fas fa-chart-bar"></i> Relatório das Decisões</h3>
                    <p>Preencha as informações específicas sobre as decisões tomadas:</p>
                    
                    <div class="relatorio-fields">
                        <div class="relatorio-field-group">
                            <label for="relatorioData">Data de Implementação</label>
                            <input type="date" id="relatorioData">
                        </div>
                        
                        <div class="relatorio-field-group">
                            <label for="relatorioResponsavel">Responsável pela Implementação</label>
                            <input type="text" id="relatorioResponsavel" placeholder="Nome do responsável">
                        </div>
                        
                        <div class="relatorio-field-group full-width">
                            <label for="relatorioObservacoes">Observações e Considerações</label>
                            <textarea id="relatorioObservacoes" placeholder="Descreva observações importantes sobre as decisões" rows="4"></textarea>
                        </div>
                        
                        <div class="relatorio-field-group full-width">
                            <label for="relatorioAnexos">Anexos e Documentos Relacionados</label>
                            <textarea id="relatorioAnexos" placeholder="Liste os anexos e documentos relacionados" rows="3"></textarea>
                        </div>
                    </div>
                    
                    <div class="relatorio-field-group full-width">
                        <label>Prazo para Implementação</label>
                        <table class="relatorio-table">
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Prazo</th>
                                    <th>Responsável</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="relatorioPrazos">
                                <tr>
                                    <td><input type="text" placeholder="Descrição do item" class="relatorio-input"></td>
                                    <td><input type="date" class="relatorio-input"></td>
                                    <td><input type="text" placeholder="Responsável" class="relatorio-input"></td>
                                    <td>
                                        <select class="relatorio-input">
                                            <option value="pendente">Pendente</option>
                                            <option value="andamento">Em Andamento</option>
                                            <option value="concluido">Concluído</option>
                                        </select>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-participant-btn" onclick="addPrazoItem()">
                            <i class="fas fa-plus"></i> Adicionar Item
                        </button>
                    </div>
                </div>
                
                <button class="btn btn-secondary" id="addDeliberation">
                    <i class="fas fa-plus"></i> Adicionar Deliberação
                </button>
                
                <div class="members-list" id="deliberationsList">
                    <!-- Deliberações serão adicionadas aqui -->
                </div>
                
                <div class="actions system-actions">
                    <button class="btn btn-secondary" id="previewBtn">Visualizar ATA</button>
                    <button class="btn btn-primary" id="generateBtn">Gerar e Salvar ATA</button>
                </div>
                
                <div class="preview-container" id="previewContainer" style="display: none;">
                    <h3>Pré-visualização da ATA</h3>
                    <div class="confidential-notice">
                        <h4><i class="fas fa-shield-alt"></i> DOCUMENTO CONFIDENCIAL</h4>
                        <p><strong>ATENÇÃO:</strong> Todo o conteúdo desta ata está sob a proteção da lei, e a divulgação de qualquer nome, dado, número, decisão, ou de qualquer informação nela contida não poderá ser realizada por qualquer meio físico ou digital, sem a autorização expressa da Associação Paulista Sudoeste dos Adventistas do Sétimo Dia. A pessoa física ou jurídica que violar essa confidencialidade estará sujeita a sanções administrativas, cíveis e penais.</p>
                    </div>
                    <div class="ata-preview" id="ataPreview">
                        <!-- ATA preview will be generated here -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="history-tab">
                <h2>Histórico de ATAs</h2>
                
                <div class="history-list" id="historyList">
                    <!-- History items will be added here -->
                </div>
                
                <div class="empty-state" id="emptyHistory" style="display: none;">
                    <i class="fas fa-history"></i>
                    <h3>Nenhuma ATA encontrada</h3>
                    <p>As atas que você criar aparecerão aqui.</p>
                </div>
            </div>
            
            <div class="tab-content" id="help-tab">
                <h2>Ajuda e Instruções</h2>
                
                <h3>Como usar o sistema</h3>
                <p>Para criar uma nova ATA, siga os passos:</p>
                <ol>
                    <li>Selecione o tipo de ATA que deseja criar</li>
                    <li>Preencha os dados básicos da reunião (número, data, local, horário)</li>
                    <li>Preencha os elementos de adoração (hino, oração, reflexão bíblica)</li>
                    <li>Adicione os participantes da reunião</li>
                    <li>Adicione as deliberações da reunião</li>
                    <li>Visualize a ATA antes de gerar o documento final</li>
                    <li>Clique em "Gerar e Salvar ATA" para finalizar</li>
                </ol>
                
                <h3>Tipos de ATA</h3>
                <ul>
                    <li><strong>Comissão Diretiva:</strong> Reuniões da comissão diretiva da igreja</li>
                    <li><strong>Reunião Regular:</strong> Reuniões regulares da igreja</li>
                    <li><strong>Reunião Administrativa:</strong> Reuniões administrativas da igreja</li>
                </ul>
                
                <h3>Recursos do Sistema</h3>
                <ul>
                    <li><strong>Histórico:</strong> Todas as ATAs criadas ficam salvas no histórico</li>
                    <li><strong>Download:</strong> É possível baixar as ATAs em formato Word</li>
                    <li><strong>Visualização:</strong> Pré-visualização da ATA antes de gerar</li>
                    <li><strong>Edição:</strong> Possibilidade de editar ATAs do histórico</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- TELA DE DÚVIDAS -->
    <div class="container screen" id="faq-screen">
        <button class="back-button" onclick="showHomeScreen()">
            <i class="fas fa-arrow-left"></i> Voltar para a Tela Inicial
        </button>
        
        <div class="card">
            <div class="intro-section">
                <h2>Dúvidas Frequentes</h2>
                <p>Encontre respostas para as perguntas mais comuns sobre o sistema de ATAs e a Igreja Adventista do Sétimo Dia.</p>
            </div>
            
            <div class="faq-section">
                <h2>Perguntas sobre o Sistema de ATAs</h2>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Como criar uma nova ATA?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Para criar uma nova ATA, acesse a seção "Criar ATA" no menu superior, selecione o tipo de reunião, preencha os dados básicos, adicione os participantes, descreva a pauta e as deliberações, e então clique em "Gerar e Salvar ATA".</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Posso editar uma ATA após gerá-la?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Sim, você pode editar ATAs existentes. Acesse o "Histórico" no sistema de ATAs, localize a ATA desejada e clique no botão "Editar". Após fazer as alterações, gere a ATA novamente para salvar as modificações.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Como faço para baixar uma ATA?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>No histórico de ATAs, ao lado de cada ATA listada, há um botão "Baixar". Clique nele para baixar a ATA em formato Word (.docx).</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Os dados ficam salvos onde?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os dados são armazenados localmente no seu navegador usando a tecnologia localStorage. Isso significa que as ATAs ficam salvas apenas no dispositivo onde foram criadas.</p>
                    </div>
                </div>
            </div>
            
            <div class="faq-section">
                <h2>Perguntas sobre a Igreja Adventista</h2>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Por que os adventistas guardam o sábado?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os adventistas guardam o sábado porque acreditam que ele é um memorial da criação estabelecido por Deus no sétimo dia (Gênesis 2:1-3) e confirmado nos Dez Mandamentos (Êxodo 20:8-11). É um dia especial de descanso, adoração e comunhão com Deus.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Qual é a visão adventista sobre a saúde?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os adventistas promovem um estilo de vida saudável baseado em princípios bíblicos, incluindo alimentação vegetariana, abstinência de álcool, tabaco e outras drogas, exercício físico adequado, confiança em Deus e equilíbrio entre trabalho e descanso.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>O que os adventistas creem sobre a segunda vinda de Cristo?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Os adventistas creem na volta visível, pessoal e iminente de Jesus Cristo. Esta crença é central para sua fé e motiva sua missão de preparar pessoas para esse evento, através da proclamação do evangelho e do cuidado integral com as pessoas.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Qual é a estrutura organizacional da Igreja Adventista?</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>A Igreja Adventista é organizada em uma estrutura representativa com quatro níveis: a igreja local, a associação/missão, a união e a Associação Geral. Cada nível tem autonomia em sua esfera de atuação, com líderes eleitos por delegados em assembleias regulares.</p>
                    </div>
                </div>
            </div>
            
            <div class="contact-form">
                <h3>Ainda tem dúvidas?</h3>
                <p>Se você não encontrou a resposta para sua pergunta, entre em contato conosco:</p>
                
                <div class="form-group">
                    <label for="contactName">Seu Nome</label>
                    <input type="text" id="contactName" placeholder="Digite seu nome">
                </div>
                
                <div class="form-group">
                    <label for="contactEmail">Seu E-mail</label>
                    <input type="email" id="contactEmail" placeholder="Digite seu e-mail">
                </div>
                
                <div class="form-group">
                    <label for="contactMessage">Sua Mensagem</label>
                    <textarea id="contactMessage" placeholder="Descreva sua dúvida ou questão" rows="5"></textarea>
                </div>
                
                <button class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Enviar Mensagem
                </button>
            </div>
        </div>
    </div>
    
    <footer>
        <p> ATA de Comissão - @2023</p>
    </footer>

    <script>
        // Variáveis globais
        let selectedCommission = '';
        let deliberations = [];
        let currentVotoType = '';
        let votoFields = {};

        // Templates para campos específicos de cada tipo de voto
        const votoTemplates = {
            '001': `
                <div class="voto-fields active" id="voto-001-fields">
                    <h4>Informações para Voz e Voto</h4>
                    <div class="voto-field-group">
                        <label>Nome do Convidado</label>
                        <input type="text" id="convidadoNome" placeholder="Nome completo do convidado">
                    </div>
                    <div class="voto-field-group">
                        <label>Motivo da Participação</label>
                        <textarea id="motivoParticipacao" placeholder="Descreva o motivo da participação do convidado"></textarea>
                    </div>
                    <div class="voto-field-group">
                        <label>Data de Validade</label>
                        <input type="date" id="validadeVoto">
                    </div>
                </div>
            `,
            '002': `
                <div class="voto-fields active" id="voto-002-fields">
                    <h4>Classificação de Membros</h4>
                    <div class="voto-field-group">
                        <label>Data de Referência</label>
                        <input type="date" id="dataReferencia">
                    </div>
                    <table class="voto-table">
                        <thead>
                            <tr>
                                <th>Classificação</th>
                                <th>Quantidade</th>
                                <th>Percentual</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Assiste em outra igreja adventista</td>
                                <td><input type="number" id="qtdOutraIgreja" placeholder="0"></td>
                                <td><input type="text" id="percOutraIgreja" placeholder="0%" readonly></td>
                            </tr>
                            <tr>
                                <td>Membros a resgatar</td>
                                <td><input type="number" id="qtdResgatar" placeholder="0"></td>
                                <td><input type="text" id="percResgatar" placeholder="0%" readonly></td>
                            </tr>
                            <tr>
                                <td>Regular frequente</td>
                                <td><input type="number" id="qtdFrequente" placeholder="0"></td>
                                <td><input type="text" id="percFrequente" placeholder="0%" readonly></td>
                            </tr>
                            <tr>
                                <td>Total de Membros</td>
                                <td><input type="number" id="totalMembros" placeholder="0" readonly></td>
                                <td><input type="text" id="totalPercentual" placeholder="100%" readonly></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `,
            '014': `
                <div class="voto-fields active" id="voto-014-fields">
                    <h4>Admissão de Membros</h4>
                    <div class="voto-field-group">
                        <label>Tipo de Admissão</label>
                        <select id="tipoAdmissao">
                            <option value="batismo">Batismo</option>
                            <option value="rebatismo">Rebatismo</option>
                            <option value="profissao-fe">Profissão de Fé</option>
                        </select>
                    </div>
                    <div class="voto-field-group">
                        <label>Data do Batismo/Admissão</label>
                        <input type="date" id="dataBatismo">
                    </div>
                    <div class="voto-field-group">
                        <label>Lista de Candidatos</label>
                        <textarea id="listaCandidatos" placeholder="Lista de nomes dos candidatos, um por linha"></textarea>
                    </div>
                    <div class="voto-field-group">
                        <label>Local do Batismo</label>
                        <input type="text" id="localBatismo" placeholder="Local onde será realizado o batismo">
                    </div>
                </div>
            `,
            '015': `
                <div class="voto-fields active" id="voto-015-fields">
                    <h4>Cartas de Transferência</h4>
                    <div class="voto-field-group">
                        <label>Tipo de Transferência</label>
                        <select id="tipoTransferencia">
                            <option value="recebimento">Recebimento</option>
                            <option value="envio">Envio</option>
                        </select>
                    </div>
                    <div class="voto-field-group">
                        <label>Igreja de Origem/Destino</label>
                        <input type="text" id="igrejaTransferencia" placeholder="Nome da igreja">
                    </div>
                    <div class="voto-field-group">
                        <label>Lista de Membros</label>
                        <textarea id="listaMembrosTransferencia" placeholder="Lista de nomes dos membros, um por linha"></textarea>
                    </div>
                    <div class="voto-field-group">
                        <label>Data da Transferência</label>
                        <input type="date" id="dataTransferencia">
                    </div>
                </div>
            `,
            '020': `
                <div class="voto-fields active" id="voto-020-fields">
                    <h4>Assembleia da Associação</h4>
                    <div class="voto-field-group">
                        <label>Nome do Delegado</label>
                        <input type="text" id="nomeDelegado" placeholder="Nome completo do delegado">
                    </div>
                    <div class="voto-field-group">
                        <label>Data da Assembleia</label>
                        <input type="date" id="dataAssembleia">
                    </div>
                    <div class="voto-field-group">
                        <label>Local da Assembleia</label>
                        <input type="text" id="localAssembleia" placeholder="Local onde será realizada a assembleia">
                    </div>
                    <div class="voto-field-group">
                        <label>Pauta Principal</label>
                        <textarea id="pautaAssembleia" placeholder="Principais assuntos da assembleia"></textarea>
                    </div>
                </div>
            `,
            '075': `
                <div class="voto-fields active" id="voto-075-fields">
                    <h4>Orçamento da Igreja</h4>
                    <div class="voto-field-group">
                        <label>Ano de Referência</label>
                        <input type="number" id="anoOrcamento" placeholder="2024" min="2020" max="2030">
                    </div>
                    <div class="voto-field-group">
                        <label>Valor Total do Orçamento</label>
                        <input type="text" id="valorTotalOrcamento" placeholder="R$ 0,00">
                    </div>
                    <table class="voto-table">
                        <thead>
                            <tr>
                                <th>Departamento</th>
                                <th>Valor Alocado</th>
                                <th>Percentual</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Administração</td>
                                <td><input type="text" id="valorAdministracao" placeholder="R$ 0,00"></td>
                                <td><input type="text" id="percAdministracao" placeholder="0%" readonly></td>
                            </tr>
                            <tr>
                                <td>Evangelismo</td>
                                <td><input type="text" id="valorEvangelismo" placeholder="R$ 0,00"></td>
                                <td><input type="text" id="percEvangelismo" placeholder="0%" readonly></td>
                            </tr>
                            <tr>
                                <td>Escola Sabatina</td>
                                <td><input type="text" id="valorEscolaSabatina" placeholder="R$ 0,00"></td>
                                <td><input type="text" id="percEscolaSabatina" placeholder="0%" readonly></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `
        };

        // Navegação entre telas
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // Atualizar botões de navegação
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ativar o botão correspondente à tela atual
            if (screenId === 'home-screen') {
                document.querySelector('.nav-btn[onclick="showHomeScreen()"]').classList.add('active');
            } else if (screenId === 'ata-system-screen') {
                document.querySelector('.nav-btn[onclick="showATASystem()"]').classList.add('active');
            } else if (screenId === 'faq-screen') {
                document.querySelector('.nav-btn[onclick="showFAQScreen()"]').classList.add('active');
            }
        }
        
        function showHomeScreen() {
            showScreen('home-screen');
            document.getElementById('subtitle').textContent = 'ATA Digital - Sistema de Registro de Atas';
        }
        
        function showATASystem() {
            if (!selectedCommission) {
                alert('Por favor, selecione um tipo de comissão antes de prosseguir.');
                return;
            }
            
            showScreen('ata-system-screen');
            document.getElementById('subtitle').textContent = 'Sistema de ATAs - ' + getCommissionName(selectedCommission);
            
            // Preencher automaticamente o tipo de ATA
            document.getElementById('ataType').value = selectedCommission;
            
            // Ir para a aba de criação
            document.querySelector('[data-tab="create"]').click();
        }
        
        function showFAQScreen() {
            showScreen('faq-screen');
            document.getElementById('subtitle').textContent = 'Dúvidas Frequentes';
        }
        
        function showHistoryScreen() {
            showScreen('ata-system-screen');
            document.querySelector('[data-tab="history"]').click();
            document.getElementById('subtitle').textContent = 'Histórico de ATAs';
        }
        
        // Seleção de comissão
        function selectCommission(commission) {
            selectedCommission = commission;
            
            // Update UI to show selected commission
            const cards = document.querySelectorAll('.commission-card');
            cards.forEach(card => {
                card.classList.remove('selected');
            });
            
            // Highlight selected card
            const selectedCard = document.querySelector(`[onclick="selectCommission('${commission}')"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
        }
        
        function getCommissionName(commission) {
            const commissionNames = {
                'comissao-diretiva': 'Comissão Diretiva',
                'reuniao-regular': 'Reunião Regular',
                'reuniao-administrativa': 'Reunião Administrativa'
            };
            
            return commissionNames[commission] || 'Reunião';
        }
        
        // Função para selecionar tipo de voto
        function selectVotoType(element) {
            // Remove selected class from all voto types
            document.querySelectorAll('.voto-type').forEach(voto => {
                voto.classList.remove('selected');
            });
            
            // Add selected class to clicked voto type
            element.classList.add('selected');
            
            // Store the selected voto type
            currentVotoType = element.getAttribute('data-voto');
            
            // Show specific fields for the selected voto type
            showVotoFields(currentVotoType);
        }

        // Função para mostrar campos específicos do tipo de voto
        function showVotoFields(votoType) {
            const container = document.getElementById('votoFieldsContainer');
            
            if (votoTemplates[votoType]) {
                container.innerHTML = votoTemplates[votoType];
                
                // Adicionar event listeners para cálculos automáticos
                if (votoType === '002') {
                    setupClassificacaoCalculations();
                } else if (votoType === '075') {
                    setupOrcamentoCalculations();
                }
            } else {
                container.innerHTML = '';
            }
        }

        // Configurar cálculos para classificação de membros
        function setupClassificacaoCalculations() {
            const inputs = ['qtdOutraIgreja', 'qtdResgatar', 'qtdFrequente'];
            
            inputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', calcularTotaisClassificacao);
                }
            });
        }

        function calcularTotaisClassificacao() {
            const qtdOutraIgreja = parseInt(document.getElementById('qtdOutraIgreja').value) || 0;
            const qtdResgatar = parseInt(document.getElementById('qtdResgatar').value) || 0;
            const qtdFrequente = parseInt(document.getElementById('qtdFrequente').value) || 0;
            
            const total = qtdOutraIgreja + qtdResgatar + qtdFrequente;
            
            document.getElementById('totalMembros').value = total;
            
            if (total > 0) {
                document.getElementById('percOutraIgreja').value = ((qtdOutraIgreja / total) * 100).toFixed(1) + '%';
                document.getElementById('percResgatar').value = ((qtdResgatar / total) * 100).toFixed(1) + '%';
                document.getElementById('percFrequente').value = ((qtdFrequente / total) * 100).toFixed(1) + '%';
                document.getElementById('totalPercentual').value = '100%';
            }
        }

        // Configurar cálculos para orçamento
        function setupOrcamentoCalculations() {
            const inputs = ['valorAdministracao', 'valorEvangelismo', 'valorEscolaSabatina'];
            const totalInput = document.getElementById('valorTotalOrcamento');
            
            inputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', calcularPercentuaisOrcamento);
                }
            });
            
            if (totalInput) {
                totalInput.addEventListener('input', calcularPercentuaisOrcamento);
            }
        }

        function calcularPercentuaisOrcamento() {
            const total = parseFloat(document.getElementById('valorTotalOrcamento').value.replace('R$', '').replace('.', '').replace(',', '.')) || 0;
            const valores = {
                administracao: parseFloat(document.getElementById('valorAdministracao').value.replace('R$', '').replace('.', '').replace(',', '.')) || 0,
                evangelismo: parseFloat(document.getElementById('valorEvangelismo').value.replace('R$', '').replace('.', '').replace(',', '.')) || 0,
                escolaSabatina: parseFloat(document.getElementById('valorEscolaSabatina').value.replace('R$', '').replace('.', '').replace(',', '.')) || 0
            };
            
            if (total > 0) {
                document.getElementById('percAdministracao').value = ((valores.administracao / total) * 100).toFixed(1) + '%';
                document.getElementById('percEvangelismo').value = ((valores.evangelismo / total) * 100).toFixed(1) + '%';
                document.getElementById('percEscolaSabatina').value = ((valores.escolaSabatina / total) * 100).toFixed(1) + '%';
            }
        }

        // Função para adicionar item de prazo
        function addPrazoItem() {
            const tbody = document.getElementById('relatorioPrazos');
            const newRow = document.createElement('tr');
            
            newRow.innerHTML = `
                <td><input type="text" placeholder="Descrição do item" class="relatorio-input"></td>
                <td><input type="date" class="relatorio-input"></td>
                <td><input type="text" placeholder="Responsável" class="relatorio-input"></td>
                <td>
                    <select class="relatorio-input">
                        <option value="pendente">Pendente</option>
                        <option value="andamento">Em Andamento</option>
                        <option value="concluido">Concluído</option>
                    </select>
                    <button type="button" class="remove-participant-btn" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </td>
            `;
            
            tbody.appendChild(newRow);
        }

        // ========== SISTEMA DE ATAS ==========
        
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar seleção padrão
            selectCommission('comissao-diretiva');
            
            // Tab functionality
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show active tab content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    // If history tab, load history
                    if (tabId === 'history') {
                        loadHistory();
                    }
                });
            });
            
            // FAQ functionality
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    item.classList.toggle('active');
                });
            });
            
            // Deliberations functionality
            const addDeliberationBtn = document.getElementById('addDeliberation');
            const deliberationTitleInput = document.getElementById('deliberationTitle');
            const deliberationDescriptionInput = document.getElementById('deliberationDescription');
            const deliberationsList = document.getElementById('deliberationsList');
            
            addDeliberationBtn.addEventListener('click', function() {
                const title = deliberationTitleInput.value.trim();
                const description = deliberationDescriptionInput.value.trim();
                
                if (title && description && currentVotoType) {
                    addDeliberation(title, description, currentVotoType);
                    deliberationTitleInput.value = '';
                    deliberationDescriptionInput.value = '';
                    
                    // Reset voto type selection
                    document.querySelectorAll('.voto-type').forEach(voto => {
                        voto.classList.remove('selected');
                    });
                    currentVotoType = '';
                    document.getElementById('votoFieldsContainer').innerHTML = '';
                } else {
                    alert('Por favor, preencha o título, descrição e selecione um tipo de voto.');
                }
            });
            
            function addDeliberation(title, description, votoType) {
                // Coletar dados dos campos específicos
                const camposEspecificos = coletarCamposVoto(votoType);
                const relatorioData = coletarDadosRelatorio();
                
                deliberations.push({
                    title,
                    description,
                    votoType,
                    number: deliberations.length + 1,
                    camposEspecificos,
                    relatorioData
                });
                renderDeliberations();
            }
            
            function coletarCamposVoto(votoType) {
                const campos = {};
                
                switch(votoType) {
                    case '001':
                        campos.convidadoNome = document.getElementById('convidadoNome')?.value || '';
                        campos.motivoParticipacao = document.getElementById('motivoParticipacao')?.value || '';
                        campos.validadeVoto = document.getElementById('validadeVoto')?.value || '';
                        break;
                    case '002':
                        campos.dataReferencia = document.getElementById('dataReferencia')?.value || '';
                        campos.classificacao = {
                            outraIgreja: document.getElementById('qtdOutraIgreja')?.value || '0',
                            resgatar: document.getElementById('qtdResgatar')?.value || '0',
                            frequente: document.getElementById('qtdFrequente')?.value || '0',
                            total: document.getElementById('totalMembros')?.value || '0'
                        };
                        break;
                    case '014':
                        campos.tipoAdmissao = document.getElementById('tipoAdmissao')?.value || '';
                        campos.dataBatismo = document.getElementById('dataBatismo')?.value || '';
                        campos.listaCandidatos = document.getElementById('listaCandidatos')?.value || '';
                        campos.localBatismo = document.getElementById('localBatismo')?.value || '';
                        break;
                    case '015':
                        campos.tipoTransferencia = document.getElementById('tipoTransferencia')?.value || '';
                        campos.igrejaTransferencia = document.getElementById('igrejaTransferencia')?.value || '';
                        campos.listaMembros = document.getElementById('listaMembrosTransferencia')?.value || '';
                        campos.dataTransferencia = document.getElementById('dataTransferencia')?.value || '';
                        break;
                    case '020':
                        campos.nomeDelegado = document.getElementById('nomeDelegado')?.value || '';
                        campos.dataAssembleia = document.getElementById('dataAssembleia')?.value || '';
                        campos.localAssembleia = document.getElementById('localAssembleia')?.value || '';
                        campos.pautaAssembleia = document.getElementById('pautaAssembleia')?.value || '';
                        break;
                    case '075':
                        campos.anoOrcamento = document.getElementById('anoOrcamento')?.value || '';
                        campos.valorTotal = document.getElementById('valorTotalOrcamento')?.value || '';
                        campos.departamentos = {
                            administracao: document.getElementById('valorAdministracao')?.value || '',
                            evangelismo: document.getElementById('valorEvangelismo')?.value || '',
                            escolaSabatina: document.getElementById('valorEscolaSabatina')?.value || ''
                        };
                        break;
                }
                
                return campos;
            }

            function coletarDadosRelatorio() {
                const prazos = [];
                const rows = document.querySelectorAll('#relatorioPrazos tr');
                
                rows.forEach(row => {
                    const inputs = row.querySelectorAll('input, select');
                    if (inputs[0]?.value) {
                        prazos.push({
                            item: inputs[0].value,
                            prazo: inputs[1].value,
                            responsavel: inputs[2].value,
                            status: inputs[3].value
                        });
                    }
                });
                
                return {
                    dataImplementacao: document.getElementById('relatorioData')?.value || '',
                    responsavel: document.getElementById('relatorioResponsavel')?.value || '',
                    observacoes: document.getElementById('relatorioObservacoes')?.value || '',
                    anexos: document.getElementById('relatorioAnexos')?.value || '',
                    prazos: prazos
                };
            }
            
            function removeDeliberation(index) {
                deliberations.splice(index, 1);
                // Renumber remaining deliberations
                deliberations.forEach((deliberation, i) => {
                    deliberation.number = i + 1;
                });
                renderDeliberations();
            }
            
            function renderDeliberations() {
                deliberationsList.innerHTML = '';
                
                if (deliberations.length === 0) {
                    deliberationsList.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 1rem;">Nenhuma deliberação adicionada</p>';
                    return;
                }
                
                deliberations.forEach((deliberation, index) => {
                    const deliberationElement = document.createElement('div');
                    deliberationElement.className = 'deliberation-item';
                    
                    let camposHTML = '';
                    if (deliberation.camposEspecificos) {
                        camposHTML = `<div class="deliberation-campos" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 6px;">
                            <strong>Informações Específicas:</strong><br>
                            ${formatarCamposEspecificos(deliberation.camposEspecificos, deliberation.votoType)}
                        </div>`;
                    }
                    
                    let relatorioHTML = '';
                    if (deliberation.relatorioData) {
                        relatorioHTML = `<div class="deliberation-relatorio" style="margin-top: 1rem; padding: 1rem; background: #e3f2fd; border-radius: 6px;">
                            <strong>Relatório:</strong><br>
                            ${formatarRelatorio(deliberation.relatorioData)}
                        </div>`;
                    }
                    
                    deliberationElement.innerHTML = `
                        <div class="deliberation-header">
                            <div class="deliberation-number">${deliberation.number}-${deliberation.votoType} ${deliberation.title}</div>
                            <div class="deliberation-actions">
                                <button class="btn btn-secondary btn-sm" onclick="removeDeliberation(${index})">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <div class="deliberation-content">
                            <div class="deliberation-description">${deliberation.description}</div>
                            ${camposHTML}
                            ${relatorioHTML}
                        </div>
                    `;
                    deliberationsList.appendChild(deliberationElement);
                });
            }

            function formatarCamposEspecificos(campos, votoType) {
                let html = '';
                
                switch(votoType) {
                    case '001':
                        html = `Convidado: ${campos.convidadoNome}<br>
                               Motivo: ${campos.motivoParticipacao}<br>
                               Validade: ${campos.validadeVoto}`;
                        break;
                    case '002':
                        html = `Data de Referência: ${campos.dataReferencia}<br>
                               Classificação: ${campos.classificacao.outraIgreja} em outra igreja, 
                               ${campos.classificacao.resgatar} a resgatar, 
                               ${campos.classificacao.frequente} frequentes<br>
                               Total: ${campos.classificacao.total} membros`;
                        break;
                    case '014':
                        html = `Tipo: ${campos.tipoAdmissao}<br>
                               Data: ${campos.dataBatismo}<br>
                               Local: ${campos.localBatismo}<br>
                               Candidatos: ${campos.listaCandidatos}`;
                        break;
                    case '015':
                        html = `Tipo: ${campos.tipoTransferencia}<br>
                               Igreja: ${campos.igrejaTransferencia}<br>
                               Data: ${campos.dataTransferencia}<br>
                               Membros: ${campos.listaMembros}`;
                        break;
                    case '020':
                        html = `Delegado: ${campos.nomeDelegado}<br>
                               Data: ${campos.dataAssembleia}<br>
                               Local: ${campos.localAssembleia}<br>
                               Pauta: ${campos.pautaAssembleia}`;
                        break;
                    case '075':
                        html = `Ano: ${campos.anoOrcamento}<br>
                               Valor Total: ${campos.valorTotal}<br>
                               Departamentos: ${campos.departamentos.administracao} (Admin), 
                               ${campos.departamentos.evangelismo} (Evangelismo), 
                               ${campos.departamentos.escolaSabatina} (Escola Sabatina)`;
                        break;
                }
                
                return html;
            }

            function formatarRelatorio(relatorioData) {
                let html = `Data de Implementação: ${relatorioData.dataImplementacao}<br>
                           Responsável: ${relatorioData.responsavel}<br>
                           Observações: ${relatorioData.observacoes}<br>`;
                
                if (relatorioData.prazos && relatorioData.prazos.length > 0) {
                    html += '<br><strong>Prazos:</strong><br>';
                    relatorioData.prazos.forEach(prazo => {
                        html += `• ${prazo.item} - ${prazo.prazo} (${prazo.responsavel}) - ${prazo.status}<br>`;
                    });
                }
                
                return html;
            }
            
            // Initialize with empty lists
            renderDeliberations();
            
            // Preview functionality
            const previewBtn = document.getElementById('previewBtn');
            const generateBtn = document.getElementById('generateBtn');
            const previewContainer = document.getElementById('previewContainer');
            const ataPreview = document.getElementById('ataPreview');
            
            previewBtn.addEventListener('click', function() {
                generatePreview();
                previewContainer.style.display = 'block';
            });
            
            function generatePreview() {
                const ataType = document.getElementById('ataType').value;
                const ataNumber = document.getElementById('ataNumber').value;
                const ataDate = document.getElementById('ataDate').value;
                const igrejaNome = document.getElementById('igrejaNome').value;
                const igrejaEndereco = document.getElementById('igrejaEndereco').value;
                const meetingTime = document.getElementById('meetingTime').value;
                const presidente = document.getElementById('presidente').value;
                const secretario = document.getElementById('secretario').value;
                const hino = document.getElementById('hino').value;
                const oracao = document.getElementById('oracao').value;
                const reflexao = document.getElementById('reflexao').value;
                const membrosPresentes = document.getElementById('membrosPresentes').value;
                const convidados = document.getElementById('convidados').value;
                
                // Format date
                const formattedDate = ataDate ? new Date(ataDate).toLocaleDateString('pt-BR') : '';
                
                // Get type label
                const typeLabels = {
                    'comissao-diretiva': 'Comissão Diretiva',
                    'reuniao-regular': 'Reunião Regular',
                    'reuniao-administrativa': 'Reunião Administrativa'
                };
                
                const typeLabel = typeLabels[ataType] || 'Reunião';
                
                ataPreview.innerHTML = `
                    <div class="ata-header">
                        <div class="ata-title">ATA DA ${typeLabel.toUpperCase()} DA</div>
                        <div class="ata-subtitle">${igrejaNome || 'IGREJA ADVENTISTA DO SÉTIMO DIA'}</div>
                        <div class="ata-subtitle">${igrejaEndereco || 'ENDEREÇO DA IGREJA'}</div>
                        <div class="ata-subtitle">${formattedDate || 'DATA'}, ${meetingTime || 'HORÁRIO'}</div>
                    </div>
                    
                    <div class="ata-body">
                        <p><strong>MEMBROS PRESENTES:</strong> ${membrosPresentes || '________________________________________________'}</p>
                        <p><strong>CONVIDADOS:</strong> ${convidados || '________________________________________________'}</p>
                        
                        <p><strong>HINO:</strong> ${hino || '__________________________'}</p>
                        <p><strong>ORAÇÃO:</strong> ${oracao || '__________________________'}</p>
                        <p><strong>REFLEXÃO BÍBLICA:</strong> ${reflexao || '__________________________'}</p>
                        
                        ${deliberations.map(deliberation => `
                            <p><strong>${deliberation.number}-${deliberation.votoType} ${deliberation.title}</strong></p>
                            <p>${deliberation.description}</p>
                            ${deliberation.camposEspecificos ? `<p><em>Detalhes: ${formatarCamposEspecificos(deliberation.camposEspecificos, deliberation.votoType)}</em></p>` : ''}
                        `).join('')}
                        
                        <p>Nada mais havendo a tratar, foi encerrada a reunião e, para constar, foi lavrada a presente ata, que será assinada pelo presidente e secretário.</p>
                    </div>
                    
                    <div class="ata-signatures">
                        <div class="signature-line">
                            <strong>${presidente || '__________________________'}</strong><br>
                            Presidente
                        </div>
                        
                        <div class="signature-line">
                            <strong>${secretario || '__________________________'}</strong><br>
                            Secretário
                        </div>
                    </div>
                `;
            }
            
            // Generate and save ATA
            generateBtn.addEventListener('click', function() {
                const ataType = document.getElementById('ataType').value;
                const ataNumber = document.getElementById('ataNumber').value;
                const ataDate = document.getElementById('ataDate').value;
                
                if (!ataType || !ataNumber || !ataDate) {
                    alert('Por favor, preencha pelo menos o tipo, número e data da ATA.');
                    return;
                }
                
                // Generate ATA data
                const ataData = {
                    id: Date.now(),
                    type: ataType,
                    number: ataNumber,
                    date: ataDate,
                    igrejaNome: document.getElementById('igrejaNome').value,
                    igrejaEndereco: document.getElementById('igrejaEndereco').value,
                    time: document.getElementById('meetingTime').value,
                    presidente: document.getElementById('presidente').value,
                    secretario: document.getElementById('secretario').value,
                    hino: document.getElementById('hino').value,
                    oracao: document.getElementById('oracao').value,
                    reflexao: document.getElementById('reflexao').value,
                    membrosPresentes: document.getElementById('membrosPresentes').value,
                    convidados: document.getElementById('convidados').value,
                    deliberations: deliberations,
                    createdAt: new Date().toISOString()
                };
                
                // Save to localStorage
                saveATA(ataData);
                
                // Generate and download Word document
                downloadATAasWord(ataData);
                
                // Show success message
                alert('ATA gerada e salva com sucesso! O arquivo Word será baixado automaticamente.');
                
                // Reset form
                resetForm();
                
                // Switch to history tab
                document.querySelector('[data-tab="history"]').click();
            });
            
            function saveATA(ataData) {
                let atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                atas.push(ataData);
                localStorage.setItem('adventist-atas', JSON.stringify(atas));
            }
            
            function loadHistory() {
                const historyList = document.getElementById('historyList');
                const emptyHistory = document.getElementById('emptyHistory');
                
                let atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                
                historyList.innerHTML = '';
                
                if (atas.length === 0) {
                    emptyHistory.style.display = 'block';
                    return;
                }
                
                emptyHistory.style.display = 'none';
                
                // Sort by date (newest first)
                atas.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                atas.forEach(ata => {
                    const typeLabels = {
                        'comissao-diretiva': 'Comissão Diretiva',
                        'reuniao-regular': 'Reunião Regular',
                        'reuniao-administrativa': 'Reunião Administrativa'
                    };
                    
                    const formattedDate = new Date(ata.date).toLocaleDateString('pt-BR');
                    const createdDate = new Date(ata.createdAt).toLocaleDateString('pt-BR');
                    
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div class="history-info">
                            <div class="history-title">ATA ${ata.number} - ${typeLabels[ata.type]}</div>
                            <div class="history-details">
                                Realizada em ${formattedDate} | Criada em ${createdDate} | 
                                ${ata.deliberations.length} deliberações
                            </div>
                        </div>
                        <div class="history-actions">
                            <button class="btn btn-secondary" onclick="viewATA(${ata.id})">
                                <i class="fas fa-eye"></i> Ver
                            </button>
                            <button class="btn btn-primary" onclick="downloadATAFromHistory(${ata.id})">
                                <i class="fas fa-download"></i> Baixar
                            </button>
                            <button class="btn btn-secondary" onclick="editATA(${ata.id})">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="btn btn-secondary" onclick="deleteATA(${ata.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    historyList.appendChild(historyItem);
                });
            }
            
            function resetForm() {
                document.getElementById('ataType').value = selectedCommission;
                document.getElementById('ataNumber').value = '';
                document.getElementById('ataDate').value = '';
                document.getElementById('igrejaNome').value = '';
                document.getElementById('igrejaEndereco').value = '';
                document.getElementById('meetingTime').value = '';
                document.getElementById('presidente').value = '';
                document.getElementById('secretario').value = '';
                document.getElementById('hino').value = '';
                document.getElementById('oracao').value = '';
                document.getElementById('reflexao').value = '';
                document.getElementById('membrosPresentes').value = '';
                document.getElementById('convidados').value = '';
                document.getElementById('deliberationTitle').value = '';
                document.getElementById('deliberationDescription').value = '';
                document.getElementById('relatorioData').value = '';
                document.getElementById('relatorioResponsavel').value = '';
                document.getElementById('relatorioObservacoes').value = '';
                document.getElementById('relatorioAnexos').value = '';
                document.getElementById('relatorioPrazos').innerHTML = `
                    <tr>
                        <td><input type="text" placeholder="Descrição do item" class="relatorio-input"></td>
                        <td><input type="date" class="relatorio-input"></td>
                        <td><input type="text" placeholder="Responsável" class="relatorio-input"></td>
                        <td>
                            <select class="relatorio-input">
                                <option value="pendente">Pendente</option>
                                <option value="andamento">Em Andamento</option>
                                <option value="concluido">Concluído</option>
                            </select>
                        </td>
                    </tr>
                `;
                deliberations = [];
                renderDeliberations();
                previewContainer.style.display = 'none';
                
                // Reset voto type selection
                document.querySelectorAll('.voto-type').forEach(voto => {
                    voto.classList.remove('selected');
                });
                currentVotoType = '';
                document.getElementById('votoFieldsContainer').innerHTML = '';
            }
            
            // Download ATA as Word document
            function downloadATAasWord(ataData) {
                const typeLabels = {
                    'comissao-diretiva': 'Comissão Diretiva',
                    'reuniao-regular': 'Reunião Regular',
                    'reuniao-administrativa': 'Reunião Administrativa'
                };
                
                const formattedDate = new Date(ataData.date).toLocaleDateString('pt-BR');
                
                // Create Word document content
                let content = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head>
                    <meta charset="utf-8">
                    <title>ATA ${ataData.number}</title>
                    <style>
                        body {
                            font-family: 'Times New Roman', serif;
                            font-size: 12pt;
                            line-height: 1.5;
                            margin: 1in;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 40px;
                        }
                        .title {
                            font-size: 16pt;
                            font-weight: bold;
                            margin-bottom: 10px;
                        }
                        .subtitle {
                            font-size: 14pt;
                            margin-bottom: 30px;
                        }
                        .body {
                            text-align: justify;
                            margin-bottom: 30px;
                        }
                        .signatures {
                            display: flex;
                            justify-content: space-between;
                            margin-top: 60px;
                        }
                        .signature-line {
                            border-top: 1px solid #000;
                            width: 220px;
                            text-align: center;
                            padding-top: 5px;
                        }
                        .confidential-notice {
                            background: #fff3cd;
                            border: 1px solid #ffeaa7;
                            border-radius: 8px;
                            padding: 15px;
                            margin-bottom: 30px;
                            font-size: 10pt;
                            color: #856404;
                        }
                    </style>
                </head>
                <body>
                    <div class="confidential-notice">
                        <h4>DOCUMENTO CONFIDENCIAL</h4>
                        <p><strong>ATENÇÃO:</strong> Todo o conteúdo desta ata está sob a proteção da lei, e a divulgação de qualquer nome, dado, número, decisão, ou de qualquer informação nela contida não poderá ser realizada por qualquer meio físico ou digital, sem a autorização expressa da Associação Paulista Sudoeste dos Adventistas do Sétimo Dia. A pessoa física ou jurídica que violar essa confidencialidade estará sujeita a sanções administrativas, cíveis e penais.</p>
                    </div>
                    
                    <div class="header">
                        <div class="title">ATA DA ${typeLabels[ataData.type].toUpperCase()} DA</div>
                        <div class="subtitle">${ataData.igrejaNome || 'IGREJA ADVENTISTA DO SÉTIMO DIA'}</div>
                        <div class="subtitle">${ataData.igrejaEndereco || 'ENDEREÇO DA IGREJA'}</div>
                        <div class="subtitle">${formattedDate}, ${ataData.time}</div>
                    </div>
                    
                    <div class="body">
                        <p><strong>MEMBROS PRESENTES:</strong> ${ataData.membrosPresentes || '________________________________________________'}</p>
                        <p><strong>CONVIDADOS:</strong> ${ataData.convidados || '________________________________________________'}</p>
                        
                        <p><strong>HINO:</strong> ${ataData.hino || '__________________________'}</p>
                        <p><strong>ORAÇÃO:</strong> ${ataData.oracao || '__________________________'}</p>
                        <p><strong>REFLEXÃO BÍBLICA:</strong> ${ataData.reflexao || '__________________________'}</p>
                `;
                
                // Add deliberations
                if (ataData.deliberations && ataData.deliberations.length > 0) {
                    ataData.deliberations.forEach(deliberation => {
                        content += `
                        <p><strong>${deliberation.number}-${deliberation.votoType} ${deliberation.title}</strong></p>
                        <p>${deliberation.description}</p>
                        `;
                        
                        // Add specific fields if available
                        if (deliberation.camposEspecificos) {
                            content += `<p><em>Detalhes: ${formatarCamposEspecificos(deliberation.camposEspecificos, deliberation.votoType)}</em></p>`;
                        }
                    });
                }
                
                content += `
                        <p>Nada mais havendo a tratar, foi encerrada a reunião e, para constar, foi lavrada a presente ata, que será assinada pelo presidente e secretário.</p>
                    </div>
                    
                    <div class="signatures">
                        <div class="signature-line">
                            <strong>${ataData.presidente}</strong><br>
                            Presidente
                        </div>
                        
                        <div class="signature-line">
                            <strong>${ataData.secretario}</strong><br>
                            Secretário
                        </div>
                    </div>
                </body>
                </html>
                `;
                
                // Create and download the Word document
                const blob = new Blob([content], { type: 'application/msword' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ATA-${ataData.number}-${formattedDate.replace(/\//g, '-')}.doc`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            // Make functions available globally for onclick handlers
            window.removeDeliberation = removeDeliberation;
            window.addPrazoItem = addPrazoItem;
            window.viewATA = function(id) {
                const atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                const ata = atas.find(a => a.id === id);
                if (ata) {
                    alert(`Visualizando ATA ${ata.number}. Em uma implementação real, isso abriria uma visualização detalhada.`);
                }
            };
            
            window.downloadATAFromHistory = function(id) {
                const atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                const ata = atas.find(a => a.id === id);
                if (ata) {
                    downloadATAasWord(ata);
                }
            };
            
            window.editATA = function(id) {
                const atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                const ata = atas.find(a => a.id === id);
                if (ata) {
                    // Switch to create tab
                    document.querySelector('[data-tab="create"]').click();
                    
                    // Fill form with ATA data
                    document.getElementById('ataType').value = ata.type;
                    document.getElementById('ataNumber').value = ata.number;
                    document.getElementById('ataDate').value = ata.date;
                    document.getElementById('igrejaNome').value = ata.igrejaNome;
                    document.getElementById('igrejaEndereco').value = ata.igrejaEndereco;
                    document.getElementById('meetingTime').value = ata.time;
                    document.getElementById('presidente').value = ata.presidente;
                    document.getElementById('secretario').value = ata.secretario;
                    document.getElementById('hino').value = ata.hino;
                    document.getElementById('oracao').value = ata.oracao;
                    document.getElementById('reflexao').value = ata.reflexao;
                    document.getElementById('membrosPresentes').value = ata.membrosPresentes;
                    document.getElementById('convidados').value = ata.convidados;
                    deliberations = ata.deliberations || [];
                    renderDeliberations();
                    
                    alert('ATA carregada para edição. Lembre-se de gerar novamente após as alterações.');
                }
            };
            
            window.deleteATA = function(id) {
                if (confirm('Tem certeza que deseja excluir esta ATA?')) {
                    let atas = JSON.parse(localStorage.getItem('adventist-atas')) || [];
                    atas = atas.filter(a => a.id !== id);
                    localStorage.setItem('adventist-atas', JSON.stringify(atas));
                    loadHistory();
                }
            };
        });
    </script>
</body>
</html>